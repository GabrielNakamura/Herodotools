<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>community-phylogenetic-metrics • Herodotools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="community-phylogenetic-metrics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Herodotools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bsm_analysis.html">Using Biogeographical Stochastic Mapping on Herodotools</a></li>
    <li><a class="dropdown-item" href="../articles/building-evoregions.html">Computing evoregions analysis</a></li>
    <li><a class="dropdown-item" href="../articles/community-phylogenetic-metrics.html">community-phylogenetic-metrics</a></li>
    <li><a class="dropdown-item" href="../articles/Intro_calc_insitu_dispersal.html">Calculating in situ diversification and historical dispersal</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>community-phylogenetic-metrics</h1>
            
      

      <div class="d-none name"><code>community-phylogenetic-metrics.Rmd</code></div>
    </div>

    
    
<div class="important">
<p>This article is under construction…</p>
</div>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gabrielnakamura.github.io/Herodotools/">Herodotools</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="phylomodelmetricscomm">Community phylogetic metrics considering in-situ
diversification<a class="anchor" aria-label="anchor" href="#phylomodelmetricscomm"></a>
</h3>
<p>We also can calculate common metrics of community phylogenetics
considering in-situ diversification dynamics. These community
phylogenetic metrics allows to disentangle the effects of in-situ
diversification from ex-situ in a similar way the in-situ
diversification metric. Namely, PD<sub>in-situ</sub> and
PE<sub>in-situ</sub>, they correspond to modified versions of the
classic Phylogenetic Diversity (PD) (Faith, 1998), and PE (Rosauer, et
al.2009), respectively. The difference is that our metrics considers
only the amount of phylogenetic diversity and endemism that emerged
after colonization and establishment of the present day lineages in the
assemblages. For this we use the function
<code>calc_insitu_metrics</code>.</p>
<p>First, we have to assign the occurrence of each species in the
evoregions. To do this we can use the function
<code>get_region_occ</code> and obtain a data frame of species in the
lines and evoregions in the columns.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">a_region</span> <span class="op">&lt;-</span> <span class="fu">Herodotools</span><span class="fu">::</span><span class="fu"><a href="../reference/get_region_occ.html">get_region_occ</a></span><span class="op">(</span>comm <span class="op">=</span> <span class="va">akodon_pa_tree</span>, site.region <span class="op">=</span> <span class="va">site_region</span><span class="op">)</span></span></code></pre></div>
<p>The object created in the last step can be used in an auxiliary
function in Herodotools to easily obtain the <a href="http://scikit-bio.org/docs/0.2.3/generated/skbio.io.phylip.html" class="external-link">Phyllip</a>
file required to run the analysis of ancestral area reconstruction using
BioGeoBEARS.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save phyllip file</span></span>
<span><span class="fu">Herodotools</span><span class="fu">::</span><span class="fu"><a href="../reference/get_tipranges_to_BioGeoBEARS.html">get_tipranges_to_BioGeoBEARS</a></span><span class="op">(</span></span>
<span>  <span class="va">a_region</span>, </span>
<span>  <span class="co"># please set a new path to save the file</span></span>
<span>  filename <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"inst"</span>, <span class="st">"extdata"</span>, <span class="st">"geo_area_akodon.data"</span><span class="op">)</span>,</span>
<span>  areanames <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Since it take some time to run BioGeoBEARS (about 15 minutes in a 4GB
processor machine), and showing how to perform analysis with
BioGeoBEARSwe are not our focus here, we can just read an output from an
ancestral analysis reconstruction performed using DEC model to
reconstruct the evoregions. If you want to check out the code used to
run the BioGeoBEARS models, you can access it with
<code>file.edit(system.file("extdata", "script", "e_01_run_DEC_model.R", package = "Herodotools"))</code>.</p>
<p>Reading the file containing the results of DEC model
reconstruction:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># ancestral reconstruction</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"resDEC_akodon.RData"</span>, package <span class="op">=</span> <span class="st">"Herodotools"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>It is worth to note that the procedures described here can be adapted
to work with any model of ancestral area reconstruction from BioGeoBEARS
(other than DEC), but for sake of simplicity we decided to use only the
<a href="https://revbayes.github.io/tutorials/biogeo/biogeo_intro.html" class="external-link">DEC
model</a>.</p>
</div>
<div class="section level2">
<h2 id="modelBasedMetrics">Merging macroevolutionary models with assemblage level metrics<a class="anchor" aria-label="anchor" href="#modelBasedMetrics"></a>
</h2>
<p>Once we have data on present-day occurrence of species, a
biogeographical regionalization (obtained with <code>evoregions</code>
function) and the ancestral area reconstruction, we can integrate these
information to calculate metrics implemented in Herodotools that
represent historical variables at assemblage scale.</p>
<div class="section level3">
<h3 id="age-of-assemblages">Age of assemblages<a class="anchor" aria-label="anchor" href="#age-of-assemblages"></a>
</h3>
<p>Let’s start by calculating the age of each cell considering the
macroevolutionary dynamics of in-situ diversification during time . The
age here corresponds to the mean arrival time of each species occupying
a given assemblage. By arrival time we mean the time in which the an
ancestor arrived and stablished (no more dispersal events in between) at
the assemblage within a region in which the current species occur today.
For the original description of this metric see <a href="https://academic.oup.com/biolinnean/article-abstract/134/1/57/6297962" class="external-link">Van
Dijk et al. 2021</a></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># converting numbers to character</span></span>
<span><span class="va">biogeo_area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>biogeo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">chartr</a></span><span class="op">(</span><span class="st">"12345"</span>, <span class="st">"ABCDE"</span>, <span class="va">evoregion_df</span><span class="op">$</span><span class="va">site_region</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># getting the ancestral range area for each node </span></span>
<span><span class="va">node_area</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">Herodotools</span><span class="fu">::</span><span class="fu"><a href="../reference/get_node_range_BioGeoBEARS.html">get_node_range_BioGeoBEARS</a></span><span class="op">(</span></span>
<span>    <span class="va">resDEC</span>,</span>
<span>    phyllip.file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"inst"</span>, <span class="st">"extdata"</span>, <span class="st">"geo_area_akodon.data"</span><span class="op">)</span>,</span>
<span>    <span class="va">akodon_newick</span>,</span>
<span>    max.range.size <span class="op">=</span> <span class="fl">4</span> </span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># calculating age arrival </span></span>
<span><span class="va">age_comm</span> <span class="op">&lt;-</span> <span class="fu">Herodotools</span><span class="fu">::</span><span class="fu"><a href="../reference/calc_age_arrival.html">calc_age_arrival</a></span><span class="op">(</span>W <span class="op">=</span> <span class="va">akodon_pa_tree</span>, </span>
<span>                        tree <span class="op">=</span> <span class="va">akodon_newick</span>, </span>
<span>                        ancestral.area <span class="op">=</span> <span class="va">node_area</span>, </span>
<span>                        biogeo <span class="op">=</span> <span class="va">biogeo_area</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">akodon_PD_PE_insitu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_insitu_metrics.html">calc_insitu_metrics</a></span><span class="op">(</span>W <span class="op">=</span> <span class="va">akodon_pa_tree</span>,</span>
<span>                  tree <span class="op">=</span> <span class="va">akodon_newick</span>, </span>
<span>                  ancestral.area <span class="op">=</span> <span class="va">node_area</span>, </span>
<span>                  biogeo <span class="op">=</span> <span class="va">biogeo_area</span>, </span>
<span>                  PD <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                  PE <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>As the other metrics we can plot PD<sub>in-situ</sub> and
PE<sub>in-situ</sub> in a map. Here we illustrate it by plotting PE and
PE<sub>in-situ</sub> metrics for comparison.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">site_xy</span>,</span>
<span>                   site_region <span class="op">=</span>  <span class="va">site_region</span>, </span>
<span>                   age <span class="op">=</span> <span class="va">age_comm</span><span class="op">$</span><span class="va">mean_age_per_assemblage</span>,</span>
<span>                   diversification <span class="op">=</span> <span class="va">akodon_diversification</span><span class="op">$</span><span class="va">Jetz_harmonic_mean_site</span>,</span>
<span>                   PE <span class="op">=</span> <span class="va">akodon_PD_PE_insitu</span><span class="op">$</span><span class="va">PE</span>, </span>
<span>                   PEinsitu <span class="op">=</span> <span class="va">akodon_PD_PE_insitu</span><span class="op">$</span><span class="va">PEinsitu</span>,</span>
<span>                   PD <span class="op">=</span> <span class="va">akodon_PD_PE_insitu</span><span class="op">$</span><span class="va">PD</span>,</span>
<span>                   PDinsitu <span class="op">=</span> <span class="va">akodon_PD_PE_insitu</span><span class="op">$</span><span class="va">PDinsitu</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map_PE</span> <span class="op">&lt;-</span> </span>
<span>   <span class="va">sites</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">LONG</span>, y <span class="op">=</span> <span class="va">LAT</span>, fill <span class="op">=</span> <span class="va">PE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>   <span class="fu">rcartocolor</span><span class="fu">::</span><span class="fu"><a href="https://jakubnowosad.com/rcartocolor/reference/carto_scale.html" class="external-link">scale_fill_carto_c</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"SunsetDark"</span>, </span>
<span>                                  direction <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                  limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.6</span><span class="op">)</span>,  <span class="co">## max percent overall</span></span>
<span>                                  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.6</span>, by <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span></span>
<span>                                  <span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">coastline</span>, size <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">map_limits</span><span class="op">$</span><span class="va">x</span>, ylim <span class="op">=</span> <span class="va">map_limits</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"PE"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colorbar</a></span><span class="op">(</span>barheight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2.3</span>, units <span class="op">=</span> <span class="st">"mm"</span><span class="op">)</span>,  </span>
<span>                               direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>                               ticks.colour <span class="op">=</span> <span class="st">"grey20"</span>,</span>
<span>                               title.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>                               label.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>                               title.hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>     legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>     axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>     legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="va">map_PEinsitu</span> <span class="op">&lt;-</span> </span>
<span>   <span class="va">sites</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">LONG</span>, y <span class="op">=</span> <span class="va">LAT</span>, fill <span class="op">=</span> <span class="va">PEinsitu</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>   <span class="fu">rcartocolor</span><span class="fu">::</span><span class="fu"><a href="https://jakubnowosad.com/rcartocolor/reference/carto_scale.html" class="external-link">scale_fill_carto_c</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"SunsetDark"</span>, </span>
<span>                                  direction <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                  limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.6</span><span class="op">)</span>,  <span class="co">## max percent overall</span></span>
<span>                                  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.6</span>, by <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span></span>
<span>                                  <span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">coastline</span>, size <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">map_limits</span><span class="op">$</span><span class="va">x</span>, ylim <span class="op">=</span> <span class="va">map_limits</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"B"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"PEinsitu"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colorbar</a></span><span class="op">(</span>barheight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2.3</span>, units <span class="op">=</span> <span class="st">"mm"</span><span class="op">)</span>,  </span>
<span>                               direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>                               ticks.colour <span class="op">=</span> <span class="st">"grey20"</span>,</span>
<span>                               title.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>                               label.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>                               title.hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>     legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>     axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>     legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="va">map_PE_all</span> <span class="op">&lt;-</span> <span class="va">map_PE</span> <span class="op">+</span> <span class="va">map_PEinsitu</span></span></code></pre></div>
<p>Figure 7 shows that the endemism pattern for Akodon assemblages are
similar for both metrics, indicating that regions with high endemism are
mainly due to in situ diversification process.</p>
</div>
<div class="section level3">
<h3 id="traitdynamics">Tip-based metrics of trait evolution<a class="anchor" aria-label="anchor" href="#traitdynamics"></a>
</h3>
<p>Here we will show how to implement three tip-based metrics proposed
by <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/ece3.8476" class="external-link">Luza
et al. (2021)</a>. Note that these tip-based metrics were estimated
using the stochastic mapping of discrete/categorical traits (diet in the
original publication), but can be extended to other traits as we will
show here. The three tip-based metrics are <em>Transition rates</em>,
<em>Stasis time</em>, and <em>Last transition time</em>, and are
implemented in the function <code>calc_tip_based_trait_evo</code>.
<em>Transition rates</em> indicate how many times the ancestral
character has changed over time. <em>Stasis time</em> indicates the
maximum branch length (time interval) which the current tip-character
was maintained across the whole phylogeny. Finally, <em>last transition
time</em> is the sum of branch lengths from the tip to the
prior/previous node with a reconstructed character equal to current
tip-character. As in the <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/ece3.8476" class="external-link">original
publication</a>, we will use the stochastic character mapping on
discrete trait data. This time, however, we will reconstruct the species
foraging strata (Elton Traits’ database, Wilman et al. 2014). We will
reconstruct the foraging strata for 214 sigmodontine rodent species with
trait and phylogenetic data (consensus phylogeny of <a href="https://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.3000494" class="external-link">Upham
et al. 2019</a>).</p>
<p>First we will load trait and phylogenetic data we need to run the
function <code>calc_tip_based_trait_evo</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"rodent_phylo"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"trait"</span><span class="op">)</span></span></code></pre></div>
<p>Now calculate the metrics.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run `calc_tip_based_trait_evo` function </span></span>
<span><span class="va">trans_rates</span> <span class="op">&lt;-</span> <span class="fu">Herodotools</span><span class="fu">::</span><span class="fu"><a href="../reference/calc_tip_based_trait_evo.html">calc_tip_based_trait_evo</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">match_data</span><span class="op">$</span><span class="va">phy</span>,</span>
<span>                                   trait <span class="op">=</span> <span class="va">trait</span> , <span class="co"># need to be named to work</span></span>
<span>                                   nsim <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                                   method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"transition_rates"</span>,</span>
<span>                                              <span class="st">"last_transition_time"</span>,</span>
<span>                                              <span class="st">"stasis_time"</span><span class="op">)</span></span>
<span>                                   <span class="op">)</span></span>
<span>  </span></code></pre></div>
<p>Since this analysis can take several minutes we can read the result
obtained using the same code above</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"transition_rate_res.RData"</span>, package <span class="op">=</span> <span class="st">"Herodotools"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now we have the estimates of the three tip-based metrics for 214
rodent species. We can summarize the tip-based metrics at the assemblage
scale. First we will load assemblage and geographic data comprising 1770
grid cells located at the Neotropics.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># load community data</span></span>
<span><span class="va">comm_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"PresAbs_228sp_Neotropical_MainDataBase_Ordenado.txt"</span>, </span>
<span>               package <span class="op">=</span> <span class="st">"Herodotools"</span><span class="op">)</span>,</span>
<span>   header <span class="op">=</span> <span class="cn">T</span>, sep <span class="op">=</span> <span class="st">"\t"</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="co"># load latlong of these communities</span></span>
<span><span class="va">geo_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Lon-lat-Disparity.txt"</span>, package <span class="op">=</span> <span class="st">"Herodotools"</span><span class="op">)</span>,</span>
<span>  header <span class="op">=</span> <span class="cn">T</span>, sep <span class="op">=</span> <span class="st">"\t"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Now we calculate the values of tip-based metrics for all species for
each assemblage.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># transition rates for each community</span></span>
<span><span class="va">averaged_rates</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">comm_data</span><span class="op">)</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># across assemblages</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="va">trans_rates</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">sims</span><span class="op">)</span> <span class="op">{</span> <span class="co"># across simulations</span></span>
<span>    </span>
<span>    <span class="co"># species in the assemblages</span></span>
<span>    <span class="va">gather_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">comm_data</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">comm_data</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># get the names</span></span>
<span>    <span class="co"># subset of rates</span></span>
<span>    <span class="va">rates</span> <span class="op">&lt;-</span> <span class="va">sims</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span> <span class="op">(</span><span class="va">sims</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">gather_names</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"prop.transitions"</span>, </span>
<span>                     <span class="st">"stasis.time"</span>,</span>
<span>                     <span class="st">"last.transition.time"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">mean_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">rates</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span> <span class="co"># and calculate the average</span></span>
<span>    <span class="va">mean_rates</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Since the last step take some minutes to complete you can opt to read
directly from the package the table with mean values for all metrics</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"averaged_rates"</span><span class="op">)</span></span></code></pre></div>
<p>We will represent in space the variation in the tip-based metrics for
rodent assemblages. It seems that, in general, assemblages of the
southern, western and northeastern Neotropics have species with higher
Transition Rates in foraging strata than communities from elsewhere
(i.e., they have many species that often changed their foraging strata
over time). Assemblage-level Stasis Time was high for two groups of
assemblages: one from northeastern Neotropics, and another in central
Amazonia. The first group in particular also showed high Transition
Rates. Taken together, these results indicate that, despite the frequent
changes in foraging strata, the species of northeastern assemblages
retained their phenotipic state during more time than the species found
elsewhere. Finally, the Last Transition Time metric shows that the
transitions leading to the present species foraging strata were older in
the i) north of the Amazonia and ii) central Mexico. These results are
potentially reflecting i) the location of arrival of ancestral
sigmodontine rodents in south America, and ii) the occurrence of several
species closely related to basal lineages.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># prepare data to map</span></span>
<span><span class="va">data_to_map_wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">geo_data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LONG"</span>, <span class="st">"LAT"</span><span class="op">)</span><span class="op">]</span>, <span class="va">averaged_rates</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_to_map_long</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data_to_map_wide</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"variables"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"values"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># create a list with the maps</span></span>
<span><span class="va">list_map_transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data_to_map_long</span><span class="op">$</span><span class="va">variables</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">metric</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">plot.title</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span></span>
<span>    <span class="va">metric</span>,</span>
<span>    <span class="st">"prop.transitions"</span> <span class="op">=</span> <span class="st">"Transition Rates"</span>,</span>
<span>    <span class="st">"stasis.time"</span> <span class="op">=</span> <span class="st">"Stasis Time"</span>,</span>
<span>    <span class="st">"last.transition.time"</span> <span class="op">=</span> <span class="st">"Last Transition Time"</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">sel_data</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">data_to_map_long</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variables</span> <span class="op">==</span> <span class="va">metric</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">var_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sel_data</span><span class="op">$</span><span class="va">values</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">var_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">var_range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">var_range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">var_range</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">sig_map_limits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sel_data</span><span class="op">$</span><span class="va">LONG</span><span class="op">)</span>, </span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sel_data</span><span class="op">$</span><span class="va">LAT</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sel_data</span>, </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">LONG</span>, y <span class="op">=</span> <span class="va">LAT</span>, fill <span class="op">=</span> <span class="va">values</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">rcartocolor</span><span class="fu">::</span><span class="fu"><a href="https://jakubnowosad.com/rcartocolor/reference/carto_scale.html" class="external-link">scale_fill_carto_c</a></span><span class="op">(</span></span>
<span>      type <span class="op">=</span> <span class="st">"quantitative"</span>, </span>
<span>      palette <span class="op">=</span> <span class="st">"SunsetDark"</span>, </span>
<span>      na.value <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>      limits <span class="op">=</span> <span class="va">var_range</span>, </span>
<span>      breaks <span class="op">=</span> <span class="va">var_breaks</span></span>
<span>    <span class="op">)</span><span class="op">+</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">coastline</span>, size <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">sig_map_limits</span><span class="op">$</span><span class="va">x</span>, ylim <span class="op">=</span> <span class="va">sig_map_limits</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colorbar</a></span><span class="op">(</span>barheight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2.3</span>, units <span class="op">=</span> <span class="st">"mm"</span><span class="op">)</span>,  </span>
<span>                                 direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>                                 ticks.colour <span class="op">=</span> <span class="st">"grey20"</span>,</span>
<span>                                 title.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>                                 label.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>                                 title.hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">plot.title</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>      axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>, </span>
<span>      axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>      plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>   </span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create map</span></span>
<span><span class="va">mapTransition_rate</span> <span class="op">&lt;-</span> <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">list_map_transitions</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gabriel Nakamura, Arthur Rodrigues, André Luza, Vanderlei Debastiani, Renan Maestri, Leandro Duarte.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
