[{"path":"https://gabrielnakamura.github.io/Herodotools/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 Gabriel Nakamura Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"reading-data-and-libraries","dir":"Articles","previous_headings":"","what":"Reading data and libraries","title":"Using Herodotools to analyses of historical biogeography","text":"First, let’s read libraries use explore data produce figures. packages already installed installed. two packages CRAN, daee BioGeoBEARS, required run analysis vignette. suggest install read packages github using following code: Now need read files corresponding distribution species phylogenetic relationship used downstream analysis Herodotools","code":"libs <- c(\"ape\", \"picante\", \"dplyr\", \"tidyr\", \"purrr\",           \"raster\", \"terra\", \"ggplot2\", \"stringr\",           \"here\", \"sf\", \"rnaturalearth\", \"rcartocolor\", \"patchwork\") if (!requireNamespace(libs, quietly = TRUE)){     install.packages(libs)   } if (!requireNamespace(c(\"daee\",\"BioGeoBEARS\"), quietly = TRUE)){   devtools::install_github(\"vanderleidebastiani/daee\")   devtools::install_github(\"nmatzke/BioGeoBEARS\") } library(daee) library(BioGeoBEARS) library(Herodotools) data(\"akodon_sites\") data(\"akodon_newick\")"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"processing","dir":"Articles","previous_headings":"","what":"Data processing","title":"Using Herodotools to analyses of historical biogeography","text":"perform data processing order get spatial occurrence information Checking species names occurrence matrix phylogenetic tree matching","code":"site_xy <- akodon_sites %>%    dplyr::select(LONG, LAT)   akodon_pa <- akodon_sites %>%    dplyr::select(-LONG, -LAT) spp_in_tree <- names(akodon_pa) %in% akodon_newick$tip.label akodon_pa_tree <- akodon_pa[, spp_in_tree]"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"exploring-spatial-patterns","dir":"Articles","previous_headings":"","what":"Exploring spatial patterns","title":"Using Herodotools to analyses of historical biogeography","text":"can observe richness pattern Akodon genus. read ggplot2 package produce maps Figure 1 - Species richness Akodon genus South America","code":"library(ggplot2) coastline <- rnaturalearth::ne_coastline(returnclass = \"sf\") map_limits <- list(   x = c(-95, -30),   y = c(-55, 12) )  richness <- rowSums(akodon_pa_tree)  map_richness <-  dplyr::bind_cols(site_xy, richness = richness) %>%    ggplot2::ggplot() +    ggplot2::geom_raster(ggplot2::aes(x = LONG, y = LAT, fill = richness)) +    rcartocolor::scale_fill_carto_c(name = \"Richness\", type = \"quantitative\", palette = \"SunsetDark\") +   ggplot2::geom_sf(data = coastline) +   ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +   ggplot2::ggtitle(\"\") +   ggplot2::xlab(\"Longitude\") +   ggplot2::ylab(\"Latitude\") +   ggplot2::labs(fill = \"Richness\") +   ggplot2::theme_bw() +   ggplot2::theme(         plot.margin = unit(c(0.1, 0.1, 0.1, 0.1), \"mm\"),         legend.text = element_text(size = 12),          axis.text = element_text(size = 7),         axis.title.x = element_text(size = 11),         axis.title.y = element_text(size = 11)         )"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"evoregions","dir":"Articles","previous_headings":"","what":"Obtaining evoregions","title":"Using Herodotools to analyses of historical biogeography","text":"use function calc_evoregion, originally described Maestri Duarte (2020), implemented Herodotools package. method classification allows perform biogeographical regionalization based phylogenetic fuzzy matrix coupled Discriminant Analysis Principal Components based k-means non-hierarchical clustering. Evoregions can viewed areas correspond centers independent diversification lineages, reflecting historical radiation single clades. calculate evoregions need occurrence matrix, phylogenetic tree define maximum number clusters allowed. user decided inform maximum number clusters, evoregion function perform automatic procedure based “elbow” method set maximum number clusters. “elbow” method implemented package phyloregion. worth note original proposition evoregion method use bootstrap method define maximum number clusters used analysis. opted use “elbow” method mainly due computational speed, since method faster bootstrap-based method. NOTE: regions obtained present different names time analysis performed, patterns . Consequently, user run code evoregions appear different names, even specifying initial seed analysis. transform evoregion results spatial object order visualize map regions. can done using following code: Evoregions can now mapped using following code Figure 2 - Evoregions Akodon species communities evoregion produced five distinct regions, cells degree affiliation region classified. Cells high affiliation indicates assemblages similar cells presented region, hand assemblages low values affiliation correspond turnover areas, words, areas multiple events colonization different lineages. Now can map evoregions affiliation cell. degree affiliation cells showed degree fading color representing evoregions. faded color cell, lesser affiliation cell evoregion. cell can interpreted zones high phylogenetic turnover. Figure 3 - Evoregion afilliation communities Akodon Genus","code":"regions <-    Herodotools::calc_evoregions(   comm = akodon_pa_tree,   phy = akodon_newick   )  site_region <- regions$cluster_evoregions evoregion_df <- data.frame(   site_xy,    site_region )  r_evoregion <- terra::rast(evoregion_df)  # Converting evoregion to a spatial polygon data frame, so it can be plotted sf_evoregion <- terra::as.polygons(r_evoregion) %>%    sf::st_as_sf()   # Downloading coastline continents and croping to keep only South America coastline <- rnaturalearth::ne_coastline(returnclass = \"sf\") map_limits <- list(   x = c(-95, -30),   y = c(-55, 12) )  # Assigning the same projection to both spatial objects sf::st_crs(sf_evoregion) <- sf::st_crs(coastline)   # Colours to plot evoregions col_five_hues <- c(   \"#3d291a\",   \"#a9344f\",   \"#578a5b\",   \"#83a6c4\",   \"#fcc573\" ) map_evoregion <-    evoregion_df %>%    ggplot2::ggplot() +    ggplot2::geom_raster(ggplot2::aes(x = LONG, y = LAT, fill = site_region)) +    ggplot2::scale_fill_manual(     name = \"\",      labels = LETTERS[1:5],     values = rev(col_five_hues)   ) +   ggplot2::geom_sf(data = coastline) +   ggplot2::geom_sf(     data = sf_evoregion,      color = \"#040400\",     fill = NA,      size = 0.2) +   ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +   ggplot2::ggtitle(\"\") +    ggplot2::theme_bw() +   ggplot2::xlab(\"Longitude\") +   ggplot2::ylab(\"Latitude\") +    ggplot2::theme(         legend.position = \"bottom\",         plot.margin = unit(c(0.1, 0.1, 0.1, 0.1), \"mm\"),         legend.text = element_text(size = 12),          axis.text = element_text(size = 7),         axis.title.x = element_text(size = 11),         axis.title.y = element_text(size = 11)         ) # Selecting only axis with more than 5% of explained variance from evoregion output axis_sel <- which(regions$PCPS$prop_explainded >= regions$PCPS$tresh_dist) PCPS_thresh <- regions$PCPS$vectors[, axis_sel]   # distance matrix using 4 significant PCPS axis accordingly to the 5% threshold  dist_phylo_PCPS <- vegan::vegdist(PCPS_thresh, method = \"euclidean\")  # calculating affiliation values for each assemblage  afi <- calc_affiliation_evoreg(phylo.comp.dist = dist_phylo_PCPS,                           groups = site_region)   # binding the information in a data frame sites <- dplyr::bind_cols(site_xy, site_region =  site_region, afi) map_joint_evoregion_afilliation <-     evoregion_df %>%     ggplot() +     ggplot2::geom_raster(ggplot2::aes(x = LONG, y = LAT, fill = site_region),                 alpha = sites[, \"afilliation\"]) +     ggplot2::scale_fill_manual(      name = \"\",       labels = LETTERS[1:5],      values = rev(col_five_hues)    ) +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::geom_sf(      data = sf_evoregion,       color = rev(col_five_hues),      fill = NA,       size = 0.7) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"\") +     guides(guide_legend(direction = \"vertical\")) +    ggplot2::theme_bw() +   ggplot2::xlab(\"Longitude\") +   ggplot2::ylab(\"Latitude\") +    ggplot2::theme(      legend.position = \"bottom\",      axis.title = element_text(size = 10)    )"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"mergeMacroAssemblage","dir":"Articles","previous_headings":"","what":"Ancestral area reconstruction for Akodon species","title":"Using Herodotools to analyses of historical biogeography","text":"section show Herodotools can use results comes macroevolutionary analysis, particularly analysis ancestral state reconstruction, understand role diversification historical dispersal assemblage level. use ancestral area reconstruction performed BioGeoBEARS, tool commonly used macroevolution. First, define occurrence species evoregions. can use function get_region_occ obtain data frame species lines evoregions columns. object created last step can used auxiliary function Herodotools easily produce Phyllip file required run analysis ancestral area reconstruction using BioGeoBEARS. Since take time run BioGeoBEARS (15 minutes 4GB processor machine), focused macroevolutionary analysis using BioGeoBEARS, can just read reconstruction model performed using DEC model reconstruct evoregions. However, want see code used run BioGeoBEARS models, can access file.edit(system.file(\"extdata\", \"script\", \"e_01_run_DEC_model.R\", package = \"Herodotools\")). Read file containing results DEC model reconstruction: worth note procedures described can adapted work model ancestral area reconstruction BioGeoBEARS, sake simplicity decided use DEC model.","code":"a_region <- Herodotools::get_region_occ(comm = akodon_pa_tree, site.region = site_region) # save phyllip file Herodotools::get_tipranges_to_BioGeoBEARS(   a_region,    # please set a new path to save the file   filename = here::here(\"inst\", \"extdata\", \"geo_area_akodon.data\"),   areanames = NULL   ) #> Warning in Herodotools::get_tipranges_to_BioGeoBEARS(a_region, filename = here::here(\"inst\", :  #> Note: assigning 'A B C D E' as area names. #> [1] \"/home/runner/work/Herodotools/Herodotools/inst/extdata/geo_area_akodon.data\" # ancestral reconstruction load(file = system.file(\"extdata\", \"resDEC_akodon.RData\", package = \"Herodotools\"))"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"modelBasedMetrics","dir":"Articles","previous_headings":"","what":"Merging macroevolutionary models with assemblage level metrics","title":"Using Herodotools to analyses of historical biogeography","text":"data present-day occurrence species, biogeographical regionalization (obtained evoregions function) ancestral area reconstruction, can integrate information calculate metrics implemented Herodotools represent historical variables assemblage scale.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"age-of-assemblages","dir":"Articles","previous_headings":"Merging macroevolutionary models with assemblage level metrics","what":"Age of assemblages","title":"Using Herodotools to analyses of historical biogeography","text":"Let’s start calculating age cell considering macroevolutionary dynamics situ diversification time . age corresponds mean arrival time species occupying given assemblage. arrival time mean ancient ancestor lineage arrived assemblage within region current species occur today. original description metric see Van Dijk et al. 2021 function calc_age_arrival returns object containing mean age assemblage. Species transition current region occurred last ancestor present can dealt two ways: default represent recent arrival age species, another option attribute age corresponding half branch length connecting ancestor present time. adopted first option. mean age assemblage can map ages assemblages Figure 4 - Age assemblages","code":"# converting numbers to character biogeo_area <- data.frame(biogeo = chartr(\"12345\", \"ABCDE\", evoregion_df$site_region))   # getting the ancestral range area for each node  node_area <-    Herodotools::get_node_range_BioGeoBEARS(     resDEC,     phyllip.file = here::here(\"inst\", \"extdata\", \"geo_area_akodon.data\"),     akodon_newick,     max.range.size = 4    )  # calculating age arrival  age_comm <- Herodotools::calc_age_arrival(W = akodon_pa_tree,                          tree = akodon_newick,                          ancestral.area = node_area,                          biogeo = biogeo_area) sites <- dplyr::bind_cols(site_xy, site_region =  site_region, age = age_comm$mean_age_per_assemblage)  map_age <-    sites %>%    ggplot() +    ggplot2::geom_raster(ggplot2::aes(x = LONG, y = LAT, fill = mean_age_arrival)) +    rcartocolor::scale_fill_carto_c(type = \"quantitative\",                       palette = \"SunsetDark\",                      direction = 1,                       limits = c(0, 3.5),  ## max percent overall                      breaks = seq(0, 3.5, by = .5),                      labels = glue::glue(\"{seq(0, 3.5, by = 0.5)}\")) +   ggplot2::geom_sf(data = coastline, size = 0.4) +   ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +   ggplot2::ggtitle(\"\") +    ggplot2::theme_bw() +   ggplot2::labs(fill = \"Mean age (Myr)\") +   ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +   ggplot2::theme(     legend.position = \"bottom\",     axis.title = element_blank(),     legend.text = element_text(size = 10),      axis.text = element_text(size = 5),     plot.subtitle = element_text(hjust = 0.5)   )"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"phylomodelmetrics","dir":"Articles","previous_headings":"Merging macroevolutionary models with assemblage level metrics","what":"Model-based diversification metrics","title":"Using Herodotools to analyses of historical biogeography","text":"can also calculate measures diversification considering macroevolutionary dynamics ancestors, specifically, can measure importance situ diversification assemblage level metrics. new measures allows decompose effects two macroevolutionary process: situ diversification ex situ. illustrate calculating common tip-based diversification measure proposed Redding Moers consists inverse equal-splits measure called Diversification Rate (DR). modified original metric take account portion evolutionary history associated region species currently occupy, value represent diversification occurred due situ diversification process result calc_insitu_diversification function consist data-frame containing value -situ diversification species assemblage vector harmonic mean -situ diversification assemblage. age, can plot -situ diversification metric look spatial patterns Akodon assemblages. Figure 5 - Diversification rates (DR - ) situ diversification rate (DRinsitu - B) Akodon assemblages","code":"akodon_diversification <-  Herodotools::calc_insitu_diversification(W = akodon_pa_tree,                    tree = akodon_newick,                     ancestral.area = node_area,                     biogeo = biogeo_area,                     diversification = \"jetz\",                    type = \"equal.splits\") sites <- dplyr::bind_cols(site_xy,                    site_region =  site_region,                    age = age_comm$mean_age_per_assemblage,                    diversification_model_based = akodon_diversification$model_based_Jetz_harmonic_mean_site,                    diversification = akodon_diversification$Jetz_harmonic_mean_site)  map_diversification <-     sites %>%     ggplot2::ggplot() +     ggplot2::geom_raster(ggplot2::aes(x = LONG, y = LAT, fill = diversification)) +     rcartocolor::scale_fill_carto_c(type = \"quantitative\", palette = \"SunsetDark\") +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"A\") +     ggplot2::theme_bw() +    ggplot2::labs(fill = \"DR\") +     ggplot2::guides(fill = guide_colorbar(barheight = unit(3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +    ggplot2::theme(      legend.position = \"bottom\",      axis.title = element_blank(),      axis.text = element_text(size = 5)    )  map_diversification_insitu <-    sites %>%    ggplot2::ggplot() +    ggplot2::geom_raster(ggplot2::aes(x = LONG, y = LAT, fill = diversification_model_based)) +    rcartocolor::scale_fill_carto_c(type = \"quantitative\",                      palette = \"SunsetDark\",                       direction = 1,                       limits = c(0, 1),  ## max percent overall                      breaks = seq(0, 1, by = .25),                      labels = glue::glue(\"{seq(0, 1, by = 0.25)}\")) +   ggplot2::geom_sf(data = coastline, size = 0.4) +   ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +   ggplot2::ggtitle(\"B\") +    ggplot2::theme_bw() +   ggplot2::labs(fill = \"DRinsitu\") +   ggplot2::guides(fill = guide_colorbar(barheight = unit(3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +   ggplot2::theme(     legend.position = \"bottom\",     axis.title = element_blank(),     legend.text = element_text(size = 6),      axis.text = element_text(size = 5),     plot.subtitle = element_text(hjust = 0.5)   )  library(patchwork) # using patchwork to put the maps together map_diversification_complete <- map_diversification + map_diversification_insitu"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"historical-dispersal-events","dir":"Articles","previous_headings":"Merging macroevolutionary models with assemblage level metrics","what":"Historical dispersal events","title":"Using Herodotools to analyses of historical biogeography","text":"can also calculate importance dispersal events related ancestral range. using function calc_dispersal_from can quantify contribution given region historical dispersal species present-day assemblages. done calculating proportion species assemblage dispersed focal ancestral range regions. calculation accounts species present events dispersal ancestral lineage, words, species presented whole history shaped situ diversification considered analysis. also can map contribution dispersal regions. Note focal area ancestral range map values dipersal , since source dispersal regions. Figure 6 - Maps showing regionalization based phylogenetic turnover (evoregion - top figure), contribution regions , B D regions regarding historical dispersal lineages","code":"akodon_dispersal <-  Herodotools::calc_dispersal_from(W = akodon_pa_tree,                tree = akodon_newick,                 ancestral.area = node_area,                 biogeo = biogeo_area) sites <- dplyr::bind_cols(site_xy,                    site_region =  site_region,                     age = age_comm$mean_age_per_assemblage,                    diversification = akodon_diversification$Jetz_harmonic_mean_site,                    diversification_model_based = akodon_diversification$model_based_Jetz_harmonic_mean_site,                    dispersal.D = akodon_dispersal[,1],                     dispersal.A = akodon_dispersal[, 2],                    dispersal.E = akodon_dispersal[, 3],                    dispersal.BD = akodon_dispersal[, 4],                    dispersal.B = akodon_dispersal[, 5])  map_dispersal_D <-     sites %>%     ggplot2::ggplot() +     ggplot2::geom_raster(ggplot2::aes(x = LONG, y = LAT, fill = dispersal.D)) +        rcartocolor::scale_fill_carto_c(       type = \"quantitative\", palette = \"SunsetDark\", na.value = \"white\", limits = c(0,1)      ) +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"From D\") +     ggplot2::theme_bw() +    ggplot2::labs(fill = \"% of contribution\") +     ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +    ggplot2::theme(     legend.position = \"bottom\",     axis.title = element_blank(),     legend.text = element_text(size = 6),      axis.text = element_text(size = 5),     plot.subtitle = element_text(hjust = 0.5)   )  map_dispersal_A <-     sites %>%     ggplot2::ggplot() +     ggplot2::geom_raster(ggplot2::aes(x = LONG, y = LAT, fill = dispersal.A)) +        rcartocolor::scale_fill_carto_c(      type = \"quantitative\", palette = \"SunsetDark\", na.value = \"white\", limits = c(0,1)      ) +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"From A\") +     ggplot2::theme_bw() +    ggplot2::labs(fill = \"% of contribution\") +    ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +    ggplot2::theme(     legend.position = \"bottom\",     axis.title = element_blank(),     legend.text = element_text(size = 6),      axis.text = element_text(size = 5),     plot.subtitle = element_text(hjust = 0.5)   )  map_dispersal_B <-     sites %>%     ggplot2::ggplot() +     ggplot2::geom_raster(ggplot2::aes(x = LONG, y = LAT, fill = dispersal.B)) +    rcartocolor::scale_fill_carto_c(      type = \"quantitative\", palette = \"SunsetDark\", na.value = \"white\", limits = c(0,1)      ) +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"From B\") +     ggplot2::theme_bw() +    ggplot2::labs(fill = \"% of\\ncontribution\") +    ggplot2::theme(      legend.position = \"right\",      axis.title = element_blank(),      legend.text = element_text(size = 6),       axis.text = element_text(size = 5),      plot.subtitle = element_text(hjust = 0.5)       )"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"phylomodelmetricscomm","dir":"Articles","previous_headings":"Merging macroevolutionary models with assemblage level metrics","what":"Model based community phylogetic metrics","title":"Using Herodotools to analyses of historical biogeography","text":"also can calculate common metrics community phylogenetics considering macroevolutionary dynamics calculation. model-based community phylogenetic metrics allows disentangle effects -situ diversification ex-situ. use function calc_insitu_metrics metrics can plot PDinsitu PEinsitu map Figure 7 - Phylogenetic endemism (), situ phylogenetic endemism (B) Akodon assemblages Figure 7 shows endemism pattern Akodon assemblages similar metrics, indicating regions high endemism mainly due -situ diversificaiton process.","code":"akodon_PD_PE_insitu <- calc_insitu_metrics(W = akodon_pa_tree,                   tree = akodon_newick,                    ancestral.area = node_area,                    biogeo = biogeo_area,                    PD = TRUE,                    PE = TRUE) sites <- dplyr::bind_cols(site_xy,                    site_region =  site_region,                     age = age_comm$mean_age_per_assemblage,                    diversification = akodon_diversification$Jetz_harmonic_mean_site,                    PE = akodon_PD_PE_insitu$PE,                     PEinsitu = akodon_PD_PE_insitu$PEinsitu,                    PD = akodon_PD_PE_insitu$PD,                    PDinsitu = akodon_PD_PE_insitu$PDinsitu)  map_PE <-     sites %>%     ggplot2::ggplot() +     ggplot2::geom_raster(ggplot2::aes(x = LONG, y = LAT, fill = PE)) +     rcartocolor::scale_fill_carto_c(palette = \"SunsetDark\",                                    direction = 1,                                    limits = c(0, 0.6),  ## max percent overall                                   breaks = seq(0, 0.6, by = .1)                                   ) +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"A\") +     ggplot2::theme_bw() +    ggplot2::labs(fill = \"PE\") +     ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +    ggplot2::theme(      legend.position = \"bottom\",      axis.title = element_blank()    )  map_PEinsitu <-     sites %>%     ggplot2::ggplot() +     ggplot2::geom_raster(ggplot2::aes(x = LONG, y = LAT, fill = PEinsitu)) +     rcartocolor::scale_fill_carto_c(palette = \"SunsetDark\",                                    direction = 1,                                    limits = c(0, 0.6),  ## max percent overall                                   breaks = seq(0, 0.6, by = .1)                                   ) +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"B\") +     ggplot2::theme_bw() +    ggplot2::labs(fill = \"PEinsitu\") +     ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +    ggplot2::theme(      legend.position = \"bottom\",      axis.title = element_blank()    )  map_PE_all <- map_PE + map_PEinsitu"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"traitdynamics","dir":"Articles","previous_headings":"Merging macroevolutionary models with assemblage level metrics","what":"Tip-based metrics of trait evolution","title":"Using Herodotools to analyses of historical biogeography","text":"show implement three tip-based metrics proposed Luza et al. (2021). Note tip-based metrics estimated using stochastic mapping discrete/categorical traits (diet original publication), can extended traits show . three tip-based metrics Transition rates, Stasis time, Last transition time, implemented function calc_tip_based_trait_evo. Transition rates indicate many times ancestral character changed time. Stasis time indicates maximum branch length (time interval) current tip-character maintained across whole phylogeny. Finally, last transition time sum branch lengths tip prior/previous node reconstructed character equal current tip-character. original publication, use stochastic character mapping discrete trait data. time, however, reconstruct species foraging strata (Elton Traits’ database, Wilman et al. 2014). reconstruct foraging strata 214 sigmodontine rodent species trait phylogenetic data (consensus phylogeny Upham et al. 2019). First load trait phylogenetic data need run function calc_tip_based_trait_evo. Now calculate metrics. Since analysis can take several minutes can read result obtained using code Now hand estimates three tip-based metrics 214 rodent species. can summarize tip-based metrics ecological assemblage scale. First load assemblage & geographic data comprising 1770 grid cells located Neotropics. Now calculate values tip-based metrics species assemblage. Since last step take minutes complete can opt read directly fom package table mean values metrics represent space variation tip-based metrics rodent assemblages. seems , general, assemblages southern, western northeastern Neotropics species higher Transition Rates foraging strata communities elsewhere (.e., many species often changed foraging strata time). Assemblage-level Stasis Time high two groups assemblages: one northeastern Neotropics, another central Amazonia. first group particular also showed high Transition Rates. Taken together, results indicate , despite frequent changes foraging strata, species northeastern assemblages retained phenotipic state time species found elsewhere. Finally, Last Transition Time metric shows transitions leading present species foraging strata older ) north Amazonia ii) central Mexico. results potentially reflecting ) location arrival ancestral sigmodontine rodents south America, ii) occurrence several species closely related basal lineages. Figure 8: Maps tip metrics evolution dynamics life mode Sigmodontine species","code":"data(\"rodent_phylo\") data(\"trait\") # run `calc_tip_based_trait_evo` function  trans_rates <- Herodotools::calc_tip_based_trait_evo(tree = match_data$phy,                                    trait = trait , # need to be named to work                                    nsim = 50,                                    method = c(\"transition_rates\",                                               \"last_transition_time\",                                               \"stasis_time\")                                    ) load(system.file(\"extdata\", \"transition_rate_res.RData\", package = \"Herodotools\")) # load community data comm_data <- read.table(    system.file(\"extdata\", \"PresAbs_228sp_Neotropical_MainDataBase_Ordenado.txt\",                 package = \"Herodotools\"),    header = T, sep = \"\\t\"    )  # load latlong of these communities geo_data <- read.table(   system.file(\"extdata\", \"Lon-lat-Disparity.txt\", package = \"Herodotools\"),   header = T, sep = \"\\t\"   ) # transition rates for each community averaged_rates <- purrr::map_dfr(1:nrow(comm_data), function (i){   # across assemblages   purrr::map_dfr(trans_rates, function (sims) { # across simulations          # species in the assemblages     gather_names <- names(comm_data[i,][which(comm_data[i,]>0)]) # get the names     # subset of rates     rates <- sims[which(rownames (sims) %in% gather_names),                    c(\"prop.transitions\",                       \"stasis.time\",                      \"last.transition.time\")]     mean_rates <- apply(rates, 2, mean) # and calculate the average     mean_rates   }) %>%      purrr::map(mean) }) data(\"averaged_rates\") # prepare data to map data_to_map_wide <- data.frame(geo_data[,c(\"LONG\", \"LAT\")], averaged_rates)  data_to_map_long <-    data_to_map_wide %>%    tidyr::pivot_longer(     cols = 3:5,     names_to = \"variables\",     values_to = \"values\"   )  # create a list with the maps list_map_transitions <- lapply(unique(data_to_map_long$variables), function(metric){      plot.title <- switch(     metric,     \"prop.transitions\" = \"Transition Rates\",     \"stasis.time\" = \"Stasis Time\",     \"last.transition.time\" = \"Last Transition Time\"   )      sel_data <-      data_to_map_long %>%      dplyr::filter(variables == metric)      var_range <- range(sel_data$values) %>% round(2)   var_breaks <- seq(var_range[1], var_range[2], diff(var_range/4)) %>% round(2)      sig_map_limits <- list(     x = range(sel_data$LONG),      y = range(sel_data$LAT)   )      ggplot() +     ggplot2::geom_raster(data = sel_data,                  ggplot2::aes(x = LONG, y = LAT, fill = values)) +     rcartocolor::scale_fill_carto_c(       type = \"quantitative\",        palette = \"SunsetDark\",        na.value = \"white\",        limits = var_range,        breaks = var_breaks     )+      ggplot2::geom_sf(data = coastline, size = 0.4) +     ggplot2::coord_sf(xlim = sig_map_limits$x, ylim = sig_map_limits$y) +     ggplot2::theme_bw() +     ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                    direction = \"horizontal\",                                  ticks.colour = \"grey20\",                                  title.position = \"top\",                                  label.position = \"bottom\",                                  title.hjust = 0.5)) +     ggplot2::labs(title = plot.title) +     ggplot2::theme(       legend.position = \"bottom\",       axis.title = element_blank(),       legend.title = element_blank(),       legend.text = element_text(size = 10),        axis.text = element_text(size = 5),       plot.subtitle = element_text(hjust = 0.5)        )    })  # Create map mapTransition_rate <- patchwork::wrap_plots(list_map_transitions) +   patchwork::plot_annotation(tag_levels = \"A\") #> Warning: Raster pixels are placed at uneven horizontal intervals and will be shifted #> ℹ Consider using `geom_tile()` instead. #> Raster pixels are placed at uneven horizontal intervals and will be shifted #> ℹ Consider using `geom_tile()` instead. #> Raster pixels are placed at uneven horizontal intervals and will be shifted #> ℹ Consider using `geom_tile()` instead. #> Raster pixels are placed at uneven horizontal intervals and will be shifted #> ℹ Consider using `geom_tile()` instead. #> Raster pixels are placed at uneven horizontal intervals and will be shifted #> ℹ Consider using `geom_tile()` instead. #> Raster pixels are placed at uneven horizontal intervals and will be shifted #> ℹ Consider using `geom_tile()` instead."},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Using Herodotools to analyses of historical biogeography","text":"Duarte, L. D. S., Debastiani, V. J., Freitas, . V. L., & Pillar, V. D. P. (2016). Dissecting phylogenetic fuzzy weighting: theory application metacommunity phylogenetics. Methods Ecology Evolution, February, 937-946. doi.org/10.1111/2041-210X.12547 Jombart, T., Devillar S., & Ballox, F. (2010). Discriminant analysis principal components: new method analysis genetically structured populations. BMC Genomic Data. Luza, . L., Maestri, R., Debastiani, V. J., Patterson, B. D., Maria, S., & Leandro, H. (2021). evolution faster ecotones? test using rates tempo diet transitions Neotropical Sigmodontinae ( Rodentia , Cricetidae ). Ecology Evolution, December, 18676–18690. https://doi.org/10.1002/ece3.8476 Maestri, R., & Duarte, L. D. S. (2020). Evoregions: Mapping shifts phylogenetic turnover across biogeographic regions Renan Maestri. Methods Ecology Evolution, 2020(August), 1652–1662. https://doi.org/10.1111/2041-210X.13492 Pigot, . Etienne, R. (2015). new dynamic null model phylogenetic community structure. Ecology Letters, 18(2), 153-163. https://doi.org/10.1111/ele.12395 Van Dijk, ., Nakamura, G., Rodrigues, . V., Maestri, R., & Duarte, L. (2021b). Imprints tropical niche conservatism historical dispersal radiation Tyrannidae (Aves: Passeriformes). Biological Journal Linnean Society, 134(1), 57–67. https://doi.org/10.1093/biolinnean/blab079","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gabriel Nakamura. Author, maintainer. Arthur Rodrigues. Author. André Luza. Author.            O-1134-2017 Vanderlei Debastiani. Author. Renan Maestri. Author. Leandro Duarte. Author.            B-6552-2012","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Nakamura G, Rodrigues , Luza , Debastiani V, Maestri R, Duarte L (2023). Herodotools: Tools Historical Biogeography analysis. R package version 1.0.0, https://gabrielnakamura.github.io/Herodotools/.","code":"@Manual{,   title = {Herodotools: Tools for Historical Biogeography analysis},   author = {Gabriel Nakamura and Arthur Rodrigues and André Luza and Vanderlei Debastiani and Renan Maestri and Leandro Duarte},   year = {2023},   note = {R package version 1.0.0},   url = {https://gabrielnakamura.github.io/Herodotools/}, }"},{"path":[]},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/index.html","id":"history-matters---some-context-on-package-name-and-aims","dir":"","previous_headings":"","what":"History matters - some context on package name and aims","title":"Tools for Historical Biogeography analysis","text":"Historical events affect daily lives many ways. never asked happen done something different past? Like classic movie Frank Capra ’s Wonderful Life, latter inspired book name great SJ Gould, changes past events shape present life dramatically. true natural world, history matters lot, species distribution ecological communities results present past events. Like ancient Greek historian geographer Herodotus, package aims put together tools allow us investigate role history systematically. However, instead narrating stories kings famous battles, hope help ecologists tell stories nature nature history shaping biodiversity. Disclosure: package logo inspired pen ink drawing Uruguayan artist Joaquín Torres Garcia called America Invertida. image closely related Garcia’s manifesto “School South,” defines : “School South’ , reality, north south. must north us, except opposition south. Therefore now turn map upside , true idea position, rest world wishes. point America, now , forever, insistently points south, north.” choose painting represent effort South American scientists trying figure north Biogeography studies.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/index.html","id":"the-package","dir":"","previous_headings":"","what":"The package","title":"Tools for Historical Biogeography analysis","text":"Herodotools R package allows us perform analysis investigate effects historical processes, specifically diversification historical dispersal, determining biodiversity structure assemblages biogeographical regions. achieved integrating tools macroevolutionary dynamics (e.g., ancestral area reconstruction, trait reconstruction) metrics commonly used community phylogenetics also providing new metrics integrate macroevolutionary dynamics assemblage biogeographical scales. functions presented Herodotools package used previous studies understand, example, imprints historical processes present day patterns diversity, macroecological patterns interplay effects ecological variation macroevolutionary dynamics general, Herodotools designed work unified platform analysis historical biogeography integrating methods Macroecology, Macroevolution Community Phylogenetics.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/index.html","id":"download","dir":"","previous_headings":"","what":"Download","title":"Tools for Historical Biogeography analysis","text":"install development version package user must type:","code":"if (!requireNamespace(\"devtools\", quietly = TRUE)){     install.packages(\"devtools\")   } devtools::install_github(\"GabrielNakamura/Herodotools\")"},{"path":"https://gabrielnakamura.github.io/Herodotools/index.html","id":"examples","dir":"","previous_headings":"","what":"Examples","title":"Tools for Historical Biogeography analysis","text":"details examples please visit Herodotools web page","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"Tools for Historical Biogeography analysis","text":"Gabriel Nakamura, Arthur Rodrigues, André Luza, Renan Maestri, Vanderlei Debastiani Leandro Duarte","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ada.html","id":null,"dir":"Reference","previous_headings":"","what":"Ancestral Diversity Analysis — ada","title":"Ancestral Diversity Analysis — ada","text":"function computes different assemblage level metrics using ancestral community reconstruction","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ada.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ancestral Diversity Analysis — ada","text":"","code":"ada(   x,   phy,   sp.bin = \"Sturges\",   marginal = FALSE,   lik.threshold = FALSE,   threshold = 0.7,   compute.fields = F )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ada.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ancestral Diversity Analysis — ada","text":"x Community occurrence matrix. Rows sites columns species phy Phylogenetic tree sp.bin Character indicating methods used compute number time slices metrics computed. Default \"Sturges\" marginal Logical indicating lik.threshold Logical indicating threshold value used select likelihood values ancestor species site. Default TRUE threshold Scalar indicating threshold value used select likelihood given species present site compute.fields Logical, indicates phylogenetic fields computed. Default FALSE","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ada.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ancestral Diversity Analysis — ada","text":"list size eight containing following objects Phylogeny Phylogenetic tree Root.Age Numeric containing root age tree used Per.node.ancestral.area Matrix containing ancestors (nodes) species Diversity..Time Age node phylogeny Cell.Metric Matrix containing assemblage level metrics richness ancestral diversity","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ada.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ancestral Diversity Analysis — ada","text":"ada function calculates ancestral assemblage reconstruction assemblage matrix using reconstruction ace function ape package","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/akodon_newick.html","id":null,"dir":"Reference","previous_headings":"","what":"Phylogenetic tree in of Akodon genus — akodon_newick","title":"Phylogenetic tree in of Akodon genus — akodon_newick","text":"phylogenetic tree containing 30 species genus Akodon","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/akodon_newick.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phylogenetic tree in of Akodon genus — akodon_newick","text":"","code":"akodon_newick"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/akodon_newick.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Phylogenetic tree in of Akodon genus — akodon_newick","text":"newick phylogenetic tree","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/akodon_sites.html","id":null,"dir":"Reference","previous_headings":"","what":"Occurrence data for Akodon species — akodon_sites","title":"Occurrence data for Akodon species — akodon_sites","text":"occurrence data species Akodon genus","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/akodon_sites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Occurrence data for Akodon species — akodon_sites","text":"","code":"akodon_sites"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/akodon_sites.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Occurrence data for Akodon species — akodon_sites","text":"data frame containing 732 rows 40 columns","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/averaged_rates.html","id":null,"dir":"Reference","previous_headings":"","what":"Averaged rates of life mode for Sigmodontinae assemblages — averaged_rates","title":"Averaged rates of life mode for Sigmodontinae assemblages — averaged_rates","text":"Data frame three columns averaged values tip based metrics trait evolution","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/averaged_rates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Averaged rates of life mode for Sigmodontinae assemblages — averaged_rates","text":"","code":"averaged_rates"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/averaged_rates.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Averaged rates of life mode for Sigmodontinae assemblages — averaged_rates","text":"object class tbl_df (inherits tbl, data.frame) 1770 rows 3 columns.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_affiliation_evoreg.html","id":null,"dir":"Reference","previous_headings":"","what":"Affiliation of assemblages based on phylogenetic turnover — calc_affiliation_evoreg","title":"Affiliation of assemblages based on phylogenetic turnover — calc_affiliation_evoreg","text":"Affiliation assemblages based phylogenetic turnover","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_affiliation_evoreg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Affiliation of assemblages based on phylogenetic turnover — calc_affiliation_evoreg","text":"","code":"calc_affiliation_evoreg(phylo.comp.dist, groups)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_affiliation_evoreg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Affiliation of assemblages based on phylogenetic turnover — calc_affiliation_evoreg","text":"phylo.comp.dist distance matrix indicating phylogenetic (taxonomic/functional) distance composition among assemblages groups character vector indicating group assemblage. object can obtained calc_evoregions","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_affiliation_evoreg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Affiliation of assemblages based on phylogenetic turnover — calc_affiliation_evoreg","text":"list two matrix, one containing affiliation values group cell classified containing cell coordinates","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_affiliation_evoreg.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Affiliation of assemblages based on phylogenetic turnover — calc_affiliation_evoreg","text":"function calculates degree affiliation community region (evoregion), community classified. used coupled analysis Principal Coordinates Phylogenetic Structure (PCPS) represent phylogenetic distances analysis output analysis represent degree membership assemblages evoregion, described Maestri Duarte 2020.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_affiliation_evoreg.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Affiliation of assemblages based on phylogenetic turnover — calc_affiliation_evoreg","text":"Maestri, R Duarte L.d.S. (2020). Evoregions: Mapping shifts phylogenetic turnover across biogeographic regions. Methods Ecology Evolution, 11, 1652-1662.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_affiliation_evoreg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Affiliation of assemblages based on phylogenetic turnover — calc_affiliation_evoreg","text":"","code":"if (FALSE) { # First run the classification #' data(akodon_newick) # phylogenetic tree data(akodon_sites) # occurrence data  akodon_pa <- akodon_sites %>%      dplyr::select(-LONG, -LAT) spp_in_tree <- names(akodon_pa) %in% akodon_newick$tip.label akodon_pa_tree <- akodon_pa[, spp_in_tree] regions <- calc_evoregions(comm = akodon_pa, phy = akodon_newick) site_region <- regions$Cluster_Evoregions # classification of each community in regions  axis_sel <- which(regions$PCPS$prop_explainded >=      regions$PCPS$tresh_dist) # significant PCPS axis PCPS_thresh <- regions$PCPS$vectors[, axis_sel] # only significant axis dist_phylo_PCPS <- vegan::vegdist(PCPS_thresh, method = \"euclidean\") # distance matrix  calc_affiliation_evoreg(phylo.comp.dist = dist_phylo_PCPS,     groups = regions$Cluster_Evoregions) # affiliation }"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_age_arrival.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes the arrival ages of each species in the assemblages — calc_age_arrival","title":"Computes the arrival ages of each species in the assemblages — calc_age_arrival","text":"Computes arrival ages species assemblages","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_age_arrival.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes the arrival ages of each species in the assemblages — calc_age_arrival","text":"","code":"calc_age_arrival(W, tree, ancestral.area, biogeo, age.no.ancestor = \"recent\")"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_age_arrival.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes the arrival ages of each species in the assemblages — calc_age_arrival","text":"W Occurrence matrix, rows assemblages columns species tree Phylogenetic tree newick format ancestral.area One column data frame, nodes row one column containing occurrence nodes biogeo One column data frame, assemblages rows one column containing region assemblage located age..ancestor character string \"recent\" (default) \"half.edge\" indicating deal cases recent aancestor tip node region. \"recent\" attributes small age (10e-5), \"half.edge\" attributes age half length branch linking ancestor tip.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_age_arrival.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes the arrival ages of each species in the assemblages — calc_age_arrival","text":"list length two. age_arrival matrix arrival age species assemblage mean_age_arrival mean age values assemblage","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_age_arrival.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Computes the arrival ages of each species in the assemblages — calc_age_arrival","text":"function computes mean arrival age species assemblage based ancestral area reconstruction. assemblage calculate arrival establishment ancestor present-day species showed Van Dijk et al (2021). consider arrival event arrival ancestor establishment ancestor present day. Arrival events occurred last speciation event lineage present time can assigned small value age corresponding half lenght branch linking ancestor present day species","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_age_arrival.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Computes the arrival ages of each species in the assemblages — calc_age_arrival","text":"Van Dijk, .; Nakamura G,; Rodrigues, .V.; Maestri, R. Duarte, L.d.S. (2021). Imprints tropical niche conservatism historical dispersal radiation Tyrannidae (Aves:Passeriformes). Biol. Journ. Linnean Soc., 134, 57-67.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_age_arrival.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Computes the arrival ages of each species in the assemblages — calc_age_arrival","text":"Gabriel Nakamura gabriel.nakamura.souza@gmail.com Arthur Rodrigues","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_age_arrival.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computes the arrival ages of each species in the assemblages — calc_age_arrival","text":"","code":"# hypothetical occurrence matrix with species in columns and assemblages in lines  W_toy<- matrix(c(0, 1, 1, 0, 1,                   1, 0, 1, 0, 1,                    0, 0, 1, 0, 0),nrow= 3,                   ncol= 5,dimnames=list(c(\"Comm 1\", \"Comm 2\", \"Comm 3\"),                   c(paste(\"s\", 1:5, sep=\"\"))))    #toy tree  data(toy_treeEx)    # hypothetical data indicating the ecoregions of each assemblage  biogeo_toy <- data.frame(Ecoregion= c(\"A\", \"B\", \"C\"))    # hypothetical data indicating the ancestral range of each node  ancestral_area_toy <- data.frame(state= c(\"ABC\", \"B\", \"C\", \"ABC\"))    # caculating age of each assemblage  age_assemblages <- calc_age_arrival(W_toy, toy_treeEx, ancestral_area_toy, biogeo_toy)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_ancestral_state.html","id":null,"dir":"Reference","previous_headings":"","what":"Ancestral State per Assemblage — calc_ancestral_state","title":"Ancestral State per Assemblage — calc_ancestral_state","text":"Ancestral State per Assemblage","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_ancestral_state.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ancestral State per Assemblage — calc_ancestral_state","text":"","code":"calc_ancestral_state(tree, ancestral.area, prefix = \"N\")"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_ancestral_state.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ancestral State per Assemblage — calc_ancestral_state","text":"tree newick phylogenetic tree object ancestral.area One column data frame. Lines nodes column biomes/region occurrence ancestors. Can obtained using (get_node_range_BioGeoBEARS) prefix single character string used name nodes","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_ancestral_state.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ancestral State per Assemblage — calc_ancestral_state","text":"data frame assemblages lines nodes columns. cell contains ancestral area/Ecoregion occurrence node respective species.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_ancestral_state.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Ancestral State per Assemblage — calc_ancestral_state","text":"Gabriel Nakamura gabriel.nakamura.souza@gmail.com","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_ancestral_state.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ancestral State per Assemblage — calc_ancestral_state","text":"","code":"biogeo_toy <- data.frame(Ecoregion= c(\"A\", \"B\", \"C\")) ancestral_area_toy <- data.frame(state= c(\"ABC\", \"B\", \"C\", \"ABC\")) calc_ancestral_state(toy_treeEx, ancestral_area_toy) #>    s1    s2    s3    s4    s5    #> N6 \"ABC\" \"ABC\" \"ABC\" \"ABC\" \"ABC\" #> N7 \"B\"   \"B\"   \"B\"   NA    NA    #> N8 \"C\"   \"C\"   NA    NA    NA    #> N9 NA    NA    NA    \"ABC\" \"ABC\""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_dispersal_from.html","id":null,"dir":"Reference","previous_headings":"","what":"Proportional contribution of an ancestral area to the species in other region — calc_dispersal_from","title":"Proportional contribution of an ancestral area to the species in other region — calc_dispersal_from","text":"species present site, function calculates proportional contribution ancestral areas dispersal lineage site's region.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_dispersal_from.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Proportional contribution of an ancestral area to the species in other region — calc_dispersal_from","text":"","code":"calc_dispersal_from(W, tree, ancestral.area, biogeo)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_dispersal_from.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Proportional contribution of an ancestral area to the species in other region — calc_dispersal_from","text":"W Occurrence matrix, rows assemblages columns species tree Phylogenetic tree newick format ancestral.area One column data frame nodes rows one column indicating occurrence (biome/ecoregion) area nodes biogeo One column data frame assemblages rows respective biome/ecoregion","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_dispersal_from.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Proportional contribution of an ancestral area to the species in other region — calc_dispersal_from","text":"data frame assemblages rows regions columns. values indicates percentage contribution region assemblage. NA represents contribution","code":""},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_dispersal_from.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Proportional contribution of an ancestral area to the species in other region — calc_dispersal_from","text":"Arthur V Rodrigues rodrigues.arthur.v@gmail.com","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_dispersal_from.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Proportional contribution of an ancestral area to the species in other region — calc_dispersal_from","text":"","code":"if (FALSE) { data(akodon_sites) # occurrence matrix akodon_pa <- akodon_sites %>% dplyr::select(-LONG, -LAT) data(akodon_newick) # phylogenetic tree spp_in_tree <- names(akodon_pa) %in% akodon_newick$tip.label akodon_pa_tree <- akodon_pa[, spp_in_tree] data(regions) # biogeographic region data(resDEC) # output from ancestral area reconstruction node.area <- get_node_range_BioGeoBEARS(resDEC,                                         phyllip.file = here::here(\"inst\",                                          \"extdata\", \"geo_area_akodon.data\")                                         ,akodon_newick,max.range.size = 4)  calc_dispersal_from(W=akodon_pa_tree,                     tree=akodon_newick,                     ancestral.area=node.area,biogeo=regions) # historical dispersal analysis }"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_evoregions.html","id":null,"dir":"Reference","previous_headings":"","what":"Defining biogeographic regions based on phylogenetic turnover — calc_evoregions","title":"Defining biogeographic regions based on phylogenetic turnover — calc_evoregions","text":"Defining biogeographic regions based phylogenetic turnover","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_evoregions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Defining biogeographic regions based on phylogenetic turnover — calc_evoregions","text":"","code":"calc_evoregions(   comm,   phy,   max.n.clust = NULL,   method.dist = \"bray\",   tresh.dist = 0.05,   method.clust = \"kmeans\",   stat.clust = \"BIC\",   n.iter.clust = 1e+07,   criterion.clust = \"diffNgroup\" )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_evoregions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Defining biogeographic regions based on phylogenetic turnover — calc_evoregions","text":"comm Species occurrence matrix. Assemblages rows species columns phy phylogenetic tree class phylo containing species comm. max.n.clust Integer value used find.clusters. Indicates maximum number clusters tried. method.dist Character. method used compute phyogenetic distances among assemblages. Dissimilarity index, accepted vegdist (Default \"bray\"). tresh.dist scalar informing threshold value select eigenvectors based amount variation eigenvector. Default 0.05 (eigenvector least 5% variation). See details. method.clust Character indicating grouping algorithm used cluster analysis. Options avalible \"kmeans\" (default) \"ward\". stat.clust Character used find.clusters indicating statistic computed model. Can \"BIC\" (default), \"AIC\" \"WSS\". n.iter.clust Integer used find.clusters function adegenet package indicate number iterations used run K-means algorithm criterion.clust Character string matching \"diffNgroup\" (default), \"min\", \"goesup\", \"smoothNgoesup\", \"goodfit\", indicating criterion automatic selection optimal number clusters. See criterion argument find.clusters explanation procedures.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_evoregions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Defining biogeographic regions based on phylogenetic turnover — calc_evoregions","text":"list length four containing: PCPS_vectors matrix PCPS vectors cluster_evoregion vector indicating region assemblage classified","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_evoregions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Defining biogeographic regions based on phylogenetic turnover — calc_evoregions","text":"evoregions performs biogeographical regionalization analysis, differently methods, evoregion uses phylogenetic turnover metric based fuzzy sets, therefore accounting characteristics evolutionary history, e.g tree imbalance, accounted metrics phylogenetic turnover.","code":""},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_evoregions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Defining biogeographic regions based on phylogenetic turnover — calc_evoregions","text":"","code":"if (FALSE) { data(akodon_sites) # occurrence data  akodon_pa <- akodon_sites %>%      dplyr::select(-LONG, -LAT) data(akodon_newick) spp_in_tree <- names(akodon_pa) %in% akodon_newick$tip.label akodon_pa_tree <- akodon_pa[, spp_in_tree] data(akodon_newick) # phylogenetic tree regions <- calc_evoregions(comm = akodon_pa_tree, phy = akodon_newick) site_region <- regions$cluster_evoregions # classification of each community in regions }"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_diversification.html","id":null,"dir":"Reference","previous_headings":"","what":"Tip-based and model-based diversification metrics — calc_insitu_diversification","title":"Tip-based and model-based diversification metrics — calc_insitu_diversification","text":"Tip-based model-based diversification metrics","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_diversification.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tip-based and model-based diversification metrics — calc_insitu_diversification","text":"","code":"calc_insitu_diversification(   W,   tree,   ancestral.area,   biogeo,   diversification = \"jetz\",   type = \"equal.splits\" )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_diversification.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tip-based and model-based diversification metrics — calc_insitu_diversification","text":"W Assemblage occurrence matrix, rows assemblages columns species tree Phylogenetic tree newick format ancestral.area One column data frame indicating Ecoregion occurrence node (rows) biogeo Data frame one column indicating Ecoregion assemblage diversification Character indicating tip-based diversification metric calculated. Default \"jetz\" type Character indicating type calculation used calculation tip-based metric, \"equal-splits\" default","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_diversification.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tip-based and model-based diversification metrics — calc_insitu_diversification","text":"list following objects: Jetz_per_sppJetz tip-based metric diversification species Jetz_species_siteMatrix containing values Jetz tip-based diversification metric assemblage Jetz_harmonic_mean_siteHarmonic mean Jetz tip-based diversification metric model_based_Jetz_species_sitesMatrix model-based Jetz metric species assemblage model_based_Jetz_harmonic_mean_siteHarmonic mean model-based Jetz diversification","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_diversification.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Tip-based and model-based diversification metrics — calc_insitu_diversification","text":"model-based measure diversification calculated proportion total tip-based diversification metric corresponded branches given species diversified current area occurrence species $$Jetz_total \\times (ED_div/ED_total)$$","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_diversification.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tip-based and model-based diversification metrics — calc_insitu_diversification","text":"Gabriel Nakamura gabriel.nakamura.souza@gmail.com Arthur V Rodrigues","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_diversification.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Tip-based and model-based diversification metrics — calc_insitu_diversification","text":"","code":"if (FALSE) { W_toy <- matrix(c(0, 1, 1, 0, 1,      1, 0, 1, 0, 1,      0, 0, 1, 0, 0),nrow= 3,     ncol= 5,dimnames=list(c(\"Comm 1\", \"Comm 2\", \"Comm 3\"),                           c(paste(\"s\", 1:5, sep=\"\")))) data(\"toy_treeEx\") toy_treeEx                    biogeo_toy <- data.frame(Ecoregion= c(\"A\", \"B\", \"C\")) ancestral_area_toy <- data.frame(state= c(\"ABC\", \"B\", \"C\", \"ABC\")) plot(toy_treeEx, show.node.label = TRUE) calc_insitu_diversification(W = W_toy,                             tree = toy_treeEx,                              ancestral.area = ancestral_area_toy,                              biogeo = biogeo_toy) }"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Diversification-based PD and PE — calc_insitu_metrics","title":"Diversification-based PD and PE — calc_insitu_metrics","text":"Diversification-based PD PE","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Diversification-based PD and PE — calc_insitu_metrics","text":"","code":"calc_insitu_metrics(W, tree, ancestral.area, biogeo, PD = TRUE, PE = TRUE)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Diversification-based PD and PE — calc_insitu_metrics","text":"W Occurrence matrix, rows assemblages columns species tree Phylogenetic hipothesis newick format ancestral.area One column data frame nodes rows one column indicating occurrence area nodes biogeo One columns data frame rows indicating assemblages one column indicating biome/ecoregion assemblage PD Logical, TRUE (default) Db-PD computed PE Logical, TRUE (default) Db-PE computed","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Diversification-based PD and PE — calc_insitu_metrics","text":"data frame containing values original PD PE also model based version","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_metrics.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Diversification-based PD and PE — calc_insitu_metrics","text":"function computes two modified versions Phylogenetic Diversity (PD) Phylogenetic endemism considering calculation -situ diversification. Db-PD Db-PE calculated coupling calculation ancetral area reconstruction divide phylogenetic tree two parts, one correspond dispersion events another correspond -situ diversification events. use -situ diversification part calculate Db-PD Db-PE","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_metrics.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Diversification-based PD and PE — calc_insitu_metrics","text":"Gabriel Nakamura gabriel.nakamura.souza@gmail.com","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_insitu_metrics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Diversification-based PD and PE — calc_insitu_metrics","text":"","code":"W_toy<- matrix(c(0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0), nrow= 3, ncol= 5, dimnames=list(c(\"Comm 1\", \"Comm 2\", \"Comm 3\"), c(paste(\"s\", 1:5, sep=\"\"))))  data(\"toy_treeEx\")  biogeo_toy <- data.frame(Ecoregion= c(\"A\", \"B\", \"C\"))  ancestral_area_toy <- data.frame(state= c(\"ABC\", \"B\", \"C\", \"ABC\"))  assemblage_phylo_metrics <- calc_insitu_metrics(W_toy,       toy_treeEx,       ancestral_area_toy,        biogeo_toy)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_spp_association_evoreg.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantifying species association with evoregions — calc_spp_association_evoreg","title":"Quantifying species association with evoregions — calc_spp_association_evoreg","text":"Quantifying species association evoregions","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_spp_association_evoreg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantifying species association with evoregions — calc_spp_association_evoreg","text":"","code":"calc_spp_association_evoreg(comm, evo.vectors, spp.association = 0.7)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_spp_association_evoreg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantifying species association with evoregions — calc_spp_association_evoreg","text":"comm matrix assemblages rows species columns evo.vectors list returned calc_evoregions function spp.association scalar indicating level association evaluated. Default 0.7","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_spp_association_evoreg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantifying species association with evoregions — calc_spp_association_evoreg","text":"matrix species association value assemblage","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_spp_association_evoreg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantifying species association with evoregions — calc_spp_association_evoreg","text":"","code":"if (FALSE) { data(akodon_sites) # occurrence data  akodon_pa <- akodon_sites %>% dplyr::select(-LONG, -LAT) data(akodon_newick) # phylogenetic tree spp_in_tree <- names(akodon_pa) %in% akodon_newick$tip.label akodon_pa_tree <- akodon_pa[, spp_in_tree] regions <- calc_evoregions(comm = akodon_pa, phy = akodon_newick) # compute evoregions calc_spp_association_evoreg(comm = akodon_pa_tree,                         evo.vectors = regions,                         spp.association = 0.7) # calculate species association }"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_tip_based_trait_evo.html","id":null,"dir":"Reference","previous_headings":"","what":"Tip-based metrics of trait evolution — calc_tip_based_trait_evo","title":"Tip-based metrics of trait evolution — calc_tip_based_trait_evo","text":"Tip-based metrics trait evolution","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_tip_based_trait_evo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tip-based metrics of trait evolution — calc_tip_based_trait_evo","text":"","code":"calc_tip_based_trait_evo(   tree,   trait,   nsim = 1,   method = c(\"transition_rates\", \"last_transition_time\", \"stasis_time\") )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_tip_based_trait_evo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tip-based metrics of trait evolution — calc_tip_based_trait_evo","text":"tree phylogenetic tree object class \"phylo\" trait named vector containing tip states discretely valued character. names must match tip labels tree. nsim Number simulations stochastic character mapping. method Tip-based metric, partial match \"transition_rates\", \"last_transition_time\" \"stasis_time\".","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_tip_based_trait_evo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tip-based metrics of trait evolution — calc_tip_based_trait_evo","text":"list (length equal nsim) tip-based metrics estimated per species.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_tip_based_trait_evo.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Tip-based metrics of trait evolution — calc_tip_based_trait_evo","text":"function calculates three metrics represent macroevolutionary dynamic traits species phylogenetic tree. Transition rates, last transition time stasis time, originally proposed Luza et al (2021). Transition rates indicate many times ancestral character changed time. Stasis time indicates maximum branch length (time interval) current tip-character maintained across whole phylogeny. Finally, last transition time sum branch lengths tip previous node reconstructed character equal current tip-character. Originally function uses stochastic character mapping discrete trait data, types trait reconstruction can used.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_tip_based_trait_evo.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tip-based metrics of trait evolution — calc_tip_based_trait_evo","text":"André Luza Vanderlei Debastiani","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/calc_tip_based_trait_evo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Tip-based metrics of trait evolution — calc_tip_based_trait_evo","text":"","code":"if (FALSE) { data(rodent.phylo) # phylogenetic tree data(trait) # categorical traits on species diet trans_rates <- calc_tip_based_trait_evo(tree=match_data$phy,trait =trait ,     nsim = 50,method = c(\"transition_rates\", \"last_transition_time\", \"stasis_time\")     ) }"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/find_max_nclust.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate the maximum number of groups in DAPC analysis — find_max_nclust","title":"Estimate the maximum number of groups in DAPC analysis — find_max_nclust","text":"Estimate maximum number groups DAPC analysis","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/find_max_nclust.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate the maximum number of groups in DAPC analysis — find_max_nclust","text":"","code":"find_max_nclust(   x,   threshold,   max.nclust,   nperm = 100,   method = \"kmeans\",   stat = \"BIC\",   criterion = \"diffNgroup\",   subset = 100,   confidence.level = c(0.7, 0.8, 0.9, 0.95, 0.99) )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/find_max_nclust.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate the maximum number of groups in DAPC analysis — find_max_nclust","text":"x data.frame matrix object containing eigenvectors sites. threshold Scalar. number eigenvectors used perform classification. max.nclust Scalar indicating maximum number groups evaluated. nperm Scalar. Number times classification performed. method c(\"kmeans\",\"ward\"). See find.clusters adegenet package. stat c(\"BIC\", \"AIC\", \"WSS\"). See find.clusters adegenet package. criterion c(\"diffNgroup\", \"min\",\"goesup\", \"smoothNgoesup\", \"goodfit\"). See find.clusters adegenet package. subset number cells used analysis. particularly important whenever total number cells large (> 1000). confidence.level threshold confidence level used estimate congruence classification pattern.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/find_max_nclust.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate the maximum number of groups in DAPC analysis — find_max_nclust","text":"Matrix containing congruence values ranging 0-1 max.nclust value (see Arguments) confidence level.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/find_max_nclust.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate the maximum number of groups in DAPC analysis — find_max_nclust","text":"","code":"if (FALSE) { data(regions) evovectors <- regions$PCPS$vectors # eigenvectors by site find_max_nclust(x=evovectors, threshold=3,max.nclust=10) }"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_node_range_BioGeoBEARS.html","id":null,"dir":"Reference","previous_headings":"","what":"Get node ranges from BioGeoBEARS biome reconstruction model — get_node_range_BioGeoBEARS","title":"Get node ranges from BioGeoBEARS biome reconstruction model — get_node_range_BioGeoBEARS","text":"auxiliary function can ancestral area reconstruction BioGeoBEARS obtain data frame containing ancestral area occurrence (biome range) ancestors (nodes)","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_node_range_BioGeoBEARS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get node ranges from BioGeoBEARS biome reconstruction model — get_node_range_BioGeoBEARS","text":"","code":"get_node_range_BioGeoBEARS(   BioGeoBEARS.data,   phyllip.file,   tree,   max.range.size )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_node_range_BioGeoBEARS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get node ranges from BioGeoBEARS biome reconstruction model — get_node_range_BioGeoBEARS","text":"BioGeoBEARS.data object containing result BioGeoBEARS reconstruction phyllip.file Phylip file, used BioGeoBEARS package tree phylogenetic tree max.range.size Scalar indicating maximum number biomes node can occupy","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_node_range_BioGeoBEARS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get node ranges from BioGeoBEARS biome reconstruction model — get_node_range_BioGeoBEARS","text":"Data frame two columns, one indicating node ancestral biome range","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_node_range_BioGeoBEARS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get node ranges from BioGeoBEARS biome reconstruction model — get_node_range_BioGeoBEARS","text":"","code":"data(resDEC) # ancestral area reconstruction from biogeobears data(akodon_newick) extdata_dir = system.file(\"extdata\", package=\"Herodotools\") fn = paste(extdata_dir, \"/geo_area_akodon.data\", sep=\"\") node_area <- get_node_range_BioGeoBEARS(resDEC,phyllip.file = fn, akodon_newick,                                         max.range.size = 4) # obtaining area for each node"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_nodes_info_core.html","id":null,"dir":"Reference","previous_headings":"","what":"Auxiliary function to compute information of node path and dispersal path for each species — get_nodes_info_core","title":"Auxiliary function to compute information of node path and dispersal path for each species — get_nodes_info_core","text":"Auxiliary function compute information node path dispersal path species","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_nodes_info_core.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auxiliary function to compute information of node path and dispersal path for each species — get_nodes_info_core","text":"","code":"get_nodes_info_core(W, tree, ancestral.area, biogeo)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_nodes_info_core.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auxiliary function to compute information of node path and dispersal path for each species — get_nodes_info_core","text":"W Numerical matrix, rows assemblages columns species tree Phylogenetic tree newick format ancestral.area Single column data frame nodes rows ancestral area/Ecoregion occurrence columns. reconstruction comes BioGeoBears data frame can obtained (get_node_range_BioGeoBEARS) biogeo Data frame containing information biome/area/ecoregion assemblage","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_nodes_info_core.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Auxiliary function to compute information of node path and dispersal path for each species — get_nodes_info_core","text":"list auxiliary information nodes species","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_nodes_info_core.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Auxiliary function to compute information of node path and dispersal path for each species — get_nodes_info_core","text":"","code":"if (FALSE) { # hypothetical occurrence matrix with species in columns and assemblages in lines  W_toy<- matrix(c(0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0),      nrow= 3,ncol= 5,      dimnames=list(c(\"Comm 1\", \"Comm 2\", \"Comm 3\"),      c(paste(\"s\", 1:5, sep=\"\"))))    #toy tree  data(toy_treeEx)    # hypothetical data indicating the ecoregions of each assemblage  biogeo_toy <- data.frame(Ecoregion= c(\"A\", \"B\", \"C\"))    # hypothetical data indicating the ancestral range of each node  ancestral_area_toy <- data.frame(state= c(\"ABC\", \"B\", \"C\", \"ABC\"))   get_nodes_info_core(W=W_toy,tree=toy_treeEx,ancestral.area=ancestral_area_toy,biogeo=biogeo_toy) }"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_region_occ.html","id":null,"dir":"Reference","previous_headings":"","what":"Species occurrence in each evoregion — get_region_occ","title":"Species occurrence in each evoregion — get_region_occ","text":"Auxiliary function produce occurrence data frame species region. object can get_tipranges_to_BioGeoBEARS function produce phyllip file needed BioGeoBEARS ancestral area reconstruction","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_region_occ.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Species occurrence in each evoregion — get_region_occ","text":"","code":"get_region_occ(comm, site.region)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_region_occ.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Species occurrence in each evoregion — get_region_occ","text":"comm Occurrence data frame species colums rows corresponding assemblages site.region character vector indicating membership assemblage regions","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_region_occ.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Species occurrence in each evoregion — get_region_occ","text":"occurrence data frame species rownames regions columns","code":""},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_region_occ.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Species occurrence in each evoregion — get_region_occ","text":"Gabriel Nakamura Arthur Rodrigues","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_region_occ.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Species occurrence in each evoregion — get_region_occ","text":"","code":"data(akodon_sites) data(akodon_newick) akodon_pa <- akodon_sites %>% dplyr::select(-LONG, -LAT) spp_in_tree <- names(akodon_pa) %in% akodon_newick$tip.label akodon_pa_tree <- akodon_pa[, spp_in_tree] data(regions) site_evoregion <- regions$Cluster_Evoregions get_region_occ(comm=akodon_pa_tree,site.region=site_evoregion) #>               A B C D E F G H I #> A_aerosus     1 1 0 0 0 0 0 0 0 #> A_affinis     0 1 0 0 0 0 0 0 0 #> A_albiventer  1 1 0 0 0 0 0 0 0 #> A_azarae      0 0 1 0 0 1 0 0 1 #> A_boliviensis 1 0 0 0 0 0 0 0 0 #> A_budini      1 0 0 0 0 0 0 0 0 #> A_cursor      0 0 0 0 0 0 0 1 0 #> A_dayi        1 0 0 1 0 0 0 0 0 #> A_dolores     0 0 1 1 0 0 0 0 0 #> A_fumeus      1 0 0 0 0 0 0 0 0 #> A_iniscatus   0 0 0 1 1 0 0 0 0 #> A_juninensis  1 0 0 0 0 0 0 0 1 #> A_kofordi     1 0 0 0 0 0 0 0 0 #> A_lindberghi  1 0 0 0 0 0 0 1 0 #> A_lutescens   1 0 0 0 0 0 0 0 0 #> A_mimus       1 0 0 0 0 0 0 0 0 #> A_mollis      0 1 0 0 0 0 0 0 0 #> A_montensis   0 0 0 0 0 0 0 1 0 #> A_mystax      0 0 0 0 0 0 0 1 0 #> A_orophilus   0 1 0 0 0 0 0 0 0 #> A_paranaensis 0 0 0 0 0 1 0 1 0 #> A_reigi       0 0 0 0 0 1 0 0 0 #> A_siberiae    1 0 0 0 0 0 0 0 0 #> A_simulator   1 0 0 0 0 0 0 0 0 #> A_spegazzinii 1 0 1 0 0 0 0 0 0 #> A_subfuscus   1 0 0 0 0 0 0 0 0 #> A_sylvanus    1 0 0 0 0 0 0 0 0 #> A_toba        0 0 1 0 0 0 1 0 0 #> A_torques     1 0 0 0 0 0 0 0 0 #> A_varius      1 0 0 0 1 0 0 0 0"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_spp_nodes.html","id":null,"dir":"Reference","previous_headings":"","what":"Species and their respective ancestral nodes — get_spp_nodes","title":"Species and their respective ancestral nodes — get_spp_nodes","text":"function computes matrix containing species respective ancestral nodes","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_spp_nodes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Species and their respective ancestral nodes — get_spp_nodes","text":"","code":"get_spp_nodes(tree, node.prefix = \"N\")"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_spp_nodes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Species and their respective ancestral nodes — get_spp_nodes","text":"tree Phylogenetic tree node.prefix Character indicating prefix used name nodes, default letter \"N\"","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_spp_nodes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Species and their respective ancestral nodes — get_spp_nodes","text":"matrix species lines nodes columns. 1 indicates node corresponds ancestor species zero indicates species share ancestor node","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_spp_nodes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Species and their respective ancestral nodes — get_spp_nodes","text":"auxiliary function , taking phylogenetic tree, allows represent matrix format relationship present-day species (tips) ancestors (nodes). function provides easy way obtain certain objects can used functions, like calc_ancestral_state","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_spp_nodes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Species and their respective ancestral nodes — get_spp_nodes","text":"","code":"data(akodon_newick) get_spp_nodes(tree = akodon_newick, node.prefix = \"N\") #>     A_mimus A_lindberghi A_subfuscus A_lutescens A_sylvanus A_boliviensis #> N31       1            1           1           1          1             1 #> N32       0            1           1           1          1             1 #> N33       0            1           1           1          1             1 #> N34       0            0           1           1          1             1 #> N35       0            0           1           1          1             1 #> N36       0            0           1           1          1             1 #> N37       0            0           1           1          1             1 #> N38       0            0           1           1          0             0 #> N39       0            0           0           0          1             1 #> N40       0            0           0           0          0             1 #> N41       0            0           0           0          0             0 #> N42       0            0           0           0          0             0 #> N43       0            0           0           0          0             0 #> N44       0            0           0           0          0             0 #> N45       0            0           0           0          0             0 #> N46       0            0           0           0          0             0 #> N47       0            0           0           0          0             0 #> N48       0            0           0           0          0             0 #> N49       0            0           0           0          0             0 #> N50       0            0           0           0          0             0 #> N51       0            0           0           0          0             0 #> N52       0            0           0           0          0             0 #> N53       0            0           0           0          0             0 #> N54       0            0           0           0          0             0 #> N55       0            0           0           0          0             0 #> N56       0            0           0           0          0             0 #> N57       0            0           0           0          0             0 #> N58       0            0           0           0          0             0 #> N59       0            0           0           0          0             0 #>     A_spegazzinii A_azarae A_fumeus A_kofordi A_juninensis A_cursor A_montensis #> N31             1        1        1         1            1        1           1 #> N32             1        1        1         1            1        1           1 #> N33             1        1        1         1            1        1           1 #> N34             1        1        1         1            1        1           1 #> N35             1        1        1         1            1        0           0 #> N36             1        1        0         0            0        0           0 #> N37             1        0        0         0            0        0           0 #> N38             0        0        0         0            0        0           0 #> N39             1        0        0         0            0        0           0 #> N40             1        0        0         0            0        0           0 #> N41             0        0        1         1            1        0           0 #> N42             0        0        1         1            0        0           0 #> N43             0        0        0         0            0        1           1 #> N44             0        0        0         0            0        0           1 #> N45             0        0        0         0            0        0           0 #> N46             0        0        0         0            0        0           0 #> N47             0        0        0         0            0        0           0 #> N48             0        0        0         0            0        0           0 #> N49             0        0        0         0            0        0           0 #> N50             0        0        0         0            0        0           0 #> N51             0        0        0         0            0        0           0 #> N52             0        0        0         0            0        0           0 #> N53             0        0        0         0            0        0           0 #> N54             0        0        0         0            0        0           0 #> N55             0        0        0         0            0        0           0 #> N56             0        0        0         0            0        0           0 #> N57             0        0        0         0            0        0           0 #> N58             0        0        0         0            0        0           0 #> N59             0        0        0         0            0        0           0 #>     A_reigi A_paranaensis A_mystax A_aerosus A_affinis A_mollis A_orophilus #> N31       1             1        1         1         1        1           1 #> N32       1             1        1         1         1        1           1 #> N33       1             1        1         0         0        0           0 #> N34       1             1        1         0         0        0           0 #> N35       0             0        0         0         0        0           0 #> N36       0             0        0         0         0        0           0 #> N37       0             0        0         0         0        0           0 #> N38       0             0        0         0         0        0           0 #> N39       0             0        0         0         0        0           0 #> N40       0             0        0         0         0        0           0 #> N41       0             0        0         0         0        0           0 #> N42       0             0        0         0         0        0           0 #> N43       1             1        1         0         0        0           0 #> N44       1             1        1         0         0        0           0 #> N45       1             1        1         0         0        0           0 #> N46       0             1        1         0         0        0           0 #> N47       0             0        0         1         1        1           1 #> N48       0             0        0         1         1        1           1 #> N49       0             0        0         1         1        1           1 #> N50       0             0        0         1         1        1           1 #> N51       0             0        0         1         1        0           0 #> N52       0             0        0         0         0        1           1 #> N53       0             0        0         0         0        1           1 #> N54       0             0        0         0         0        0           0 #> N55       0             0        0         0         0        0           0 #> N56       0             0        0         0         0        0           0 #> N57       0             0        0         0         0        0           0 #> N58       0             0        0         0         0        0           0 #> N59       0             0        0         0         0        0           0 #>     A_torques A_budini A_siberiae A_simulator A_varius A_albiventer A_iniscatus #> N31         1        1          1           1        1            1           1 #> N32         1        1          1           1        1            1           1 #> N33         0        0          0           0        0            0           0 #> N34         0        0          0           0        0            0           0 #> N35         0        0          0           0        0            0           0 #> N36         0        0          0           0        0            0           0 #> N37         0        0          0           0        0            0           0 #> N38         0        0          0           0        0            0           0 #> N39         0        0          0           0        0            0           0 #> N40         0        0          0           0        0            0           0 #> N41         0        0          0           0        0            0           0 #> N42         0        0          0           0        0            0           0 #> N43         0        0          0           0        0            0           0 #> N44         0        0          0           0        0            0           0 #> N45         0        0          0           0        0            0           0 #> N46         0        0          0           0        0            0           0 #> N47         1        1          1           1        1            1           1 #> N48         1        1          1           1        1            1           0 #> N49         1        1          1           1        1            0           0 #> N50         1        0          0           0        0            0           0 #> N51         0        0          0           0        0            0           0 #> N52         1        0          0           0        0            0           0 #> N53         0        0          0           0        0            0           0 #> N54         0        1          1           1        1            0           0 #> N55         0        1          1           0        0            0           0 #> N56         0        0          0           1        1            0           0 #> N57         0        0          0           0        0            0           1 #> N58         0        0          0           0        0            0           0 #> N59         0        0          0           0        0            0           0 #>     A_dayi A_toba A_dolores #> N31      1      1         1 #> N32      1      1         1 #> N33      0      0         0 #> N34      0      0         0 #> N35      0      0         0 #> N36      0      0         0 #> N37      0      0         0 #> N38      0      0         0 #> N39      0      0         0 #> N40      0      0         0 #> N41      0      0         0 #> N42      0      0         0 #> N43      0      0         0 #> N44      0      0         0 #> N45      0      0         0 #> N46      0      0         0 #> N47      1      1         1 #> N48      0      0         0 #> N49      0      0         0 #> N50      0      0         0 #> N51      0      0         0 #> N52      0      0         0 #> N53      0      0         0 #> N54      0      0         0 #> N55      0      0         0 #> N56      0      0         0 #> N57      1      1         1 #> N58      1      1         1 #> N59      0      1         1"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_tipranges_to_BioGeoBEARS.html","id":null,"dir":"Reference","previous_headings":"","what":"Generates lagrangePHYLIP file for using in BioGeoBEARS — get_tipranges_to_BioGeoBEARS","title":"Generates lagrangePHYLIP file for using in BioGeoBEARS — get_tipranges_to_BioGeoBEARS","text":"prepares save file used geographical areas BioGeoBEARS scripts. based save_tipranges_to_LagrangePHYLIP function BioGEOBEARS package.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_tipranges_to_BioGeoBEARS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generates lagrangePHYLIP file for using in BioGeoBEARS — get_tipranges_to_BioGeoBEARS","text":"","code":"get_tipranges_to_BioGeoBEARS(   tip_range,   filename = \"lagrange_area_data_file.data\",   areanames = NULL )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_tipranges_to_BioGeoBEARS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generates lagrangePHYLIP file for using in BioGeoBEARS — get_tipranges_to_BioGeoBEARS","text":"tip_range data frame. Tip names rows, geographical areas columns. Please provide tip names row.names. See example. filename filename store data. default \"lagrange_area_data_file.data\". areanames names areas. defaut area names generated sequencial upper case letters.","code":""},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/plot_ada.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotting ancestral area character in space — plot_ada","title":"Plotting ancestral area character in space — plot_ada","text":"Plotting ancestral area character space","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/plot_ada.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotting ancestral area character in space — plot_ada","text":"","code":"plot_ada(   ada.res,   grid,   coords,   resolution,   patterns = \"all\",   color_palette = \"SunsetDark\",   projection = \"+proj=robin\" )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/plot_ada.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotting ancestral area character in space — plot_ada","text":"ada.res object ada function grid spatial object containing cells used calculate ancestral diversity distribution ada coords two column matrix containing values Longitude (first column) Latitude (second column) resolution Scalar informing resolution grids grid object patterns Character, vector containing names metrics spatialized \"\" create map metrics.  characters allowed passed \"rich\", \"Nnodes\", \"PeakDiv\", \"Skewness\", \"LowDistPeak\", \"HighDistPeak\", \"PeakRange\". Default \"\" color_palette Character indicating palette used plot spatial patterns. can one option present scale_fill_carto_c function. Default \"SunsetDark\" projection Character indicating projection used spatial plots. Default \"+proj=robin\"","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/plot_ada.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plotting ancestral area character in space — plot_ada","text":"list containing spatial plots metrics calculated ada.res","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/regions.html","id":null,"dir":"Reference","previous_headings":"","what":"Output from evoregion function with classification of 732 assemblages — regions","title":"Output from evoregion function with classification of 732 assemblages — regions","text":"Object containing list two objects: $PCPS list containing eigenvectors PCPS analysis $Cluster_Evoregions vector containing groups assemblage","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/regions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Output from evoregion function with classification of 732 assemblages — regions","text":"","code":"regions"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/regions.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Output from evoregion function with classification of 732 assemblages — regions","text":"object class evoregion length 2.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/resDEC.html","id":null,"dir":"Reference","previous_headings":"","what":"Output from BioGeoBEARS — resDEC","title":"Output from BioGeoBEARS — resDEC","text":"Object ancestral reconstruction model BioGeoBEARS","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/resDEC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Output from BioGeoBEARS — resDEC","text":"","code":"resDEC"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/resDEC.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Output from BioGeoBEARS — resDEC","text":"list obtained BioGeoBEARS Akodon species","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/rodent_phylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Phylogenetic tree with 285 species — rodent_phylo","title":"Phylogenetic tree with 285 species — rodent_phylo","text":"Dated () phylogenetic tree newick format containing 285 sigmodontine species","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/rodent_phylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phylogenetic tree with 285 species — rodent_phylo","text":"","code":"rodent_phylo"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/rodent_phylo.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Phylogenetic tree with 285 species — rodent_phylo","text":"Newick phylogenetic tree","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/toy_treeEx.html","id":null,"dir":"Reference","previous_headings":"","what":"Hypothetical phylogenetic tree — toy_treeEx","title":"Hypothetical phylogenetic tree — toy_treeEx","text":"made data simulates phylogenetic tree newick format. tree contains five species annotations node corresponds occurrence area ancestors","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/toy_treeEx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hypothetical phylogenetic tree — toy_treeEx","text":"","code":"toy_treeEx"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/toy_treeEx.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Hypothetical phylogenetic tree — toy_treeEx","text":"newick phylogenetic tree 5 species","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/trait.html","id":null,"dir":"Reference","previous_headings":"","what":"Trait on foraging strata for small rodent — trait","title":"Trait on foraging strata for small rodent — trait","text":"Character vector indicating foraging strata 214 species small rodents","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/trait.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trait on foraging strata for small rodent — trait","text":"","code":"trait"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/trait.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Trait on foraging strata for small rodent — trait","text":"character vector three categories: Ar Arboreal G Ground level S Scansorial","code":""}]
