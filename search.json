[{"path":"https://gabrielnakamura.github.io/Herodotools/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 Gabriel Nakamura Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"history-matters---some-context-on-package-name-and-aims","dir":"Articles","previous_headings":"","what":"History matters - some context on package name and aims","title":"Introduction to Herodotools","text":"Historical events affects daily lives many ways. never asked happened done something different past? Like classic movie Frank Capra ’s Wonderful Life, latter inspiration book name great SJ Gould, changes past events change dramatically present life. true natural world, history matters lot, distribution species ecological communities result present past events. Like ancient Greek historian geographer Herodotus, package aims put together tools allows investigate systematic way role history, instead narrating kings famous battles, hope help ecologist explaining natural world. article show main functions Herodotools. evaluate effects deep past processes, represented diversification historical dispersal, structure phenotype assemblages species genus Akodon. aim perform following steps: Process raw occurrence data phylogenetic information Classify Akodon assemblages meaningful regions using evoregion function Calculate macroevolutionary model-based metrics diversification using ancestral state reconstruction model Calculate model-based community phylogenetic metrics Calculate ti/model-based metrics trait macroevolutionary dynamics","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"reading-data-and-libraries","dir":"Articles","previous_headings":"","what":"Reading data and libraries","title":"Introduction to Herodotools","text":"First, let’s read libraries use explore data produce figures Herodotools installed use following code install package github repository: read files corresponding distribution species, phylogenetic relationship trait values (represented body size) type:","code":"library(ape) library(picante) library(dplyr) library(tidyr) library(purrr) library(raster) library(terra) library(ggplot2) library(stringr) library(here) library(sf) library(rnaturalearth) library(rcartocolor) library(patchwork) devtools::install_github(\"GabrielNakamura/Herodotools\") library(Herodotools) akodon.sites <- read.table(system.file(\"extdata\", \"Table_Akodon_coords_pa.txt\", package = \"Herodotools\"),                             header = TRUE) akodon.newick <- ape::read.tree(system.file(\"extdata\", \"akodon.new\", package = \"Herodotools\"))"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"processing","dir":"Articles","previous_headings":"","what":"Data processing","title":"Introduction to Herodotools","text":"perform data processing order get spatial occurrence information Checking species names occurrence matrix phylogenetic tree matching","code":"site.xy <- akodon.sites %>%    dplyr::select(LONG, LAT)  akodon.pa <- akodon.sites %>%    dplyr::select(-LONG, -LAT) spp.in.tree <- names(akodon.pa) %in% akodon.newick$tip.label akodon.pa.tree <- akodon.pa[, spp.in.tree]"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"exploring-spatial-patterns","dir":"Articles","previous_headings":"","what":"Exploring spatial patterns","title":"Introduction to Herodotools","text":"can observe richness pattern Akodon genus","code":"coastline <- rnaturalearth::ne_coastline(returnclass = \"sf\") map_limits <- list(   x = c(-95, -30),   y = c(-55, 12) )  richness <- rowSums(akodon.pa.tree)  map_richness <-  dplyr::bind_cols(site.xy, richness = richness) %>%    ggplot2::ggplot() +    ggplot2::geom_raster(aes(x = LONG, y = LAT, fill = richness)) +    rcartocolor::scale_fill_carto_c(name = \"Richness\", type = \"quantitative\", palette = \"SunsetDark\") +   ggplot2::geom_sf(data = coastline) +   ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +   ggplot2::ggtitle(\"Richness for Akodon Genus\") +   ggplot2::theme_bw()"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"evoregions","dir":"Articles","previous_headings":"","what":"Obtaining evoregions","title":"Introduction to Herodotools","text":"use function evoregion, originally described Maestri Duarte (2020), implemented Herodotools package. method classification allows perform biogeographical regionalization based phylogenetic fuzzy matrix coupled Discriminant Analysis Principal Components based k-means non-hierarchical clustering. Evoregions can viewed areas correspond centers independent diversification lineages, reflecting historical radiation single clades. calculate evoregions need occurrence matrix, phylogenetic tree define maximum number clusters allowed group analyzed. user decided inform maximum number clusters, evoregion function perform automatic procedure based “elbow” method set maximum number clusters. “elbow” method implemented package phyloregion. worth note original proposition evoregion method use bootstrapt method define maximmun number clusters used analysis. opted use “elbow” method mainly due computational speed, since method faster bootstrap-based method. NOTE: regions obtained present different names time analysis performed, patterns . Consequently, user run code evoregions appear different names. transform evoregion results spatial object order visualize map regions. can done using following code: Evoregions can now mapped using following code  evoregion produced five distinct regions, cells degree affiliation associated region classified. Cells high affiliation indicates assemblages similar cells presented region, hand assemblages low values affiliation correspond turnover areas, words, areas multiple events colonization different lineages. Now can map evoregions affiliation cell. degree affiliation cells showed degree fade color. fade color cell, lesser affiliation cell evoregion. cell can interpreted zones high phylogenetic turnover.","code":"regions <-    Herodotools::evoregions(   comm = akodon.pa.tree,   phy = akodon.newick   )  site.region <- regions$Cluster_Evoregions evoregion.df <- data.frame(   site.xy,    site.region )  r.evoregion <- terra::rast(evoregion.df)  # Converting evoregion to a spatial polygon data frame, so it can be plotted sf.evoregion <- terra::as.polygons(r.evoregion) %>%    sf::st_as_sf()   # Downloading coastline continents and croping to keep only South America coastline <- rnaturalearth::ne_coastline(returnclass = \"sf\") map_limits <- list(   x = c(-95, -30),   y = c(-55, 12) )  # Assigning the same projection to both spatial objects sf::st_crs(sf.evoregion) <- st_crs(coastline)   # Colours to plot evoregions col_five_hues <- c(   \"#3d291a\",   \"#a9344f\",   \"#578a5b\",   \"#83a6c4\",   \"#fcc573\" ) map_evoregion <-    evoregion.df %>%    ggplot2::ggplot() +    ggplot2::geom_raster(aes(x = LONG, y = LAT, fill = site.region)) +    ggplot2::scale_fill_manual(     name = \"\",      labels = LETTERS[1:5],     values = rev(col_five_hues)   ) +   ggplot2::geom_sf(data = coastline) +   ggplot2::geom_sf(     data = sf.evoregion,      color = \"#040400\",     fill = NA,      size = 0.2) +   ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +   ggplot2::ggtitle(\"A\") +    ggplot2::theme_bw() +   ggplot2::theme(     legend.position = \"bottom\",     axis.title = element_blank(),     axis.text = element_text(size = 5),     plot.subtitle = element_text(hjust = 0.5),     legend.text = element_text(family = \"Arial\", color = \"black\", size = 8)   ) # Selecting only axis with more than 5% of explained variance from evoregion output axis_sel <- which(regions$PCPS$prop_explainded >= regions$PCPS$tresh_dist) PCPS_thresh <- regions$PCPS$vectors[, axis_sel]   # distance matrix using 4 significant PCPS axis accordingly to the 5% threshold  dist_phylo_PCPS <- vegan::vegdist(PCPS_thresh, method = \"euclidean\")  # calculating affiliation values for each assemblage  afi <- affiliation_evoreg(phylo.comp.dist = dist_phylo_PCPS,                           groups = regions$Cluster_Evoregions)   # binding the information in a data frame sites <- bind_cols(site.xy, site.region =  site.region, afi) map_joint_evoregion_afilliation <-     evoregion.df %>%     ggplot() +     ggplot2::geom_raster(aes(x = LONG, y = LAT, fill = site.region),                 alpha = sites[, \"afilliation\"]) +     ggplot2::scale_fill_manual(      name = \"\",       labels = LETTERS[1:5],      values = rev(col_five_hues)    ) +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::geom_sf(      data = sf.evoregion,       color = rev(col_five_hues),      fill = NA,       size = 0.7) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"Evoregion and afilliation for Akodon Genus\") +     guides(guide_legend(direction = \"vertical\")) +    ggplot2::theme_bw() +    ggplot2::theme(      legend.position = \"bottom\",      axis.title = element_blank()    )"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"mergeMacroAssemblage","dir":"Articles","previous_headings":"","what":"Ancestral area reconstruction for Akodon species","title":"Introduction to Herodotools","text":"section show Herodotools can use results comes macroevolutionary analysis, particularly analysis ancestral state reconstruction, understand role diversification historical dispersal assemblage level. use ancestral area reconstruction performed using BioGeoBEARS, tool commonly used macroevolution studies. First, define occurrence species regarding evoregions. correspond current area species. object created last step can used auxiliary function present Herodotools easily produce Phyllip file required run analysis ancestral area reconstruction using BioGeoBEARS. Since take time run BioGeoBEARS (15 minutes 4GB processor machine), objective tutorial show run reconstruction using BioGeoBEARS can just read reconstruction model perfomed using DEC model reconstruct evoregions. However want see code used run BioGeoBEARS models, code file.edit(system.file(\"extdata\", \"script\", \"e_01_run_DEC_model.R\", package = \"Herodotools\")). Read file containing results DEC model reconstruction: worth note procedures decribed work model ancestral area reconstruction, sake simplicity decided use DEC model.","code":"Herodotools::a_region <- region_occ(comm = akodon.pa.tree, site.region = site.region) # save phyllip file Herodotools::tipranges_to_BioGeoBEARS(   a_region,    # please set a new path to save the file   filename = here(\"inst\", \"extdata\", \"geo_area_akodon.data\"),   areanames = NULL   ) # ancestral reconstruction load(file = system.file(\"extdata\", \"resDEC_akodon.RData\", package = \"Herodotools\"))"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"modelBasedMetrics","dir":"Articles","previous_headings":"","what":"Merging macroevolutionary models with assemblage level metrics","title":"Introduction to Herodotools","text":"occurrence data distribution, biogeographical regionalization (obtained evoregions function) ancestral area reconstruction can integrate three information calculate metrics represents historical variables spatial scale.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"age-of-assemblages","dir":"Articles","previous_headings":"Merging macroevolutionary models with assemblage level metrics","what":"Age of assemblages","title":"Introduction to Herodotools","text":"Let’s start calculating age cell considering macroevolutionary dynamics occupancy regions time. age corresponds mean arrival time species occupying given assemblage. arrival time mean ancient ancestor lineage arrived assemblage within region current species occur today. original description metric see Van Dijk et al. 2021 function age_arrival returns object containing mean age assemblage. Species transition current region occurred last ancestor present can dealt two ways: default represent low arrival value species, another option attribute age corresponding half branch length connecting ancestor present time. adopted first option. mean age assemblage can map ages assemblages","code":"# converting numbers to character biogeo_area <- data.frame(biogeo = chartr(\"12345\", \"ABCDE\", evoregion.df$site.region))   # getting the ancestral range area for each node  node.area <-    Herodotools::get_node_range_BioGeoBEARS(     resDEC,     phyllip.file = here(\"inst\", \"extdata\", \"geo_area_akodon.data\"),     akodon.newick,     max.range.size = 4    )  # calculating age arrival  age_comm <- Herodotools::age_arrival(W = akodon.pa.tree,                          tree = akodon.newick,                          ancestral.area = node.area,                          biogeo = biogeo_area) sites <- dplyr::bind_cols(site.xy, site.region =  site.region, age = age_comm$mean_age_per_assemblage)  map_age <-    sites %>%    ggplot() +    ggplot2::geom_raster(aes(x = LONG, y = LAT, fill = mean_age_arrival)) +    scale_fill_carto_c(type = \"quantitative\",                       palette = \"SunsetDark\",                      direction = 1,                       limits = c(0, 3.5),  ## max percent overall                      breaks = seq(0, 3.5, by = .5),                      labels = glue::glue(\"{seq(0, 3.5, by = 0.5)}\")) +   ggplot2::geom_sf(data = coastline, size = 0.4) +   ggplot2::geom_sf(     data = sf.evoregion,      color = rev(col_five_hues),     fill = NA,      size = 0.7) +   ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +   ggplot2::ggtitle(\"B\") +    ggplot2::ggplot2::theme_bw() +   ggplot2::labs(fill = \"Mean age (Myr)\") +   ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +   ggplot2::theme(     legend.position = \"bottom\",     axis.title = element_blank(),     legend.text = element_text(size = 10),      axis.text = element_text(size = 5),     plot.subtitle = element_text(hjust = 0.5)   )"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"phylomodelmetrics","dir":"Articles","previous_headings":"Merging macroevolutionary models with assemblage level metrics","what":"Model-based diversification metrics","title":"Introduction to Herodotools","text":"can also calculate measures diversification considering macroevolutionary dynamics ancestor area. new measures allows decompose effects two macroevolutionary process: situ diversification historical dispersal. illustrate calculating common tip-based diversification measure propposed Jetz 2012 consists inverse equal-splits measure called Diversification Rate (DR). modified original metric take account portion evolutionary history associated region species currently occupy, value represent diversification occurred due situ diversification process result db_diversification function composed data-frame containing value -situ diversification species assemblage vector harmonic mean -situ diversification assemblage. age, can plot model based diversification metric look spatial patterns -situ diversification Akodon assemblages.","code":"akodon_diversification <-  Herodotools::db_diversification(W = akodon.pa.tree,                    tree = akodon.newick,                     ancestral.area = node.area,                     biogeo = biogeo_area,                     diversification = \"jetz\",                    type = \"equal.splits\") sites <- dplyr::bind_cols(site.xy,                    site.region =  site.region,                    age = age_comm$mean_age_per_assemblage,                    diversification_model_based = akodon_diversification$model_based_Jetz_harmonic_mean_site,                    diversification = akodon_diversification$Jetz_harmonic_mean_site)  map_diversification <-     sites %>%     ggplot2::ggplot() +     ggplot2::geom_raster(aes(x = LONG, y = LAT, fill = diversification)) +     scale_fill_carto_c(type = \"quantitative\", palette = \"SunsetDark\") +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::geom_sf(      data = sf.evoregion,       color = rev(col_five_hues),      fill = NA,       size = 0.7) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"Diversification *sensu* Jetz\") +     ggplot2::ggplot2::theme_bw() +    ggplot2::labs(fill = \"Harmonic mean diversification\") +     ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +    ggplot2::theme(      legend.position = \"bottom\",      axis.title = element_blank()    )  map_diversification_model_based <-    sites %>%    ggplot2::ggplot() +    ggplot2::geom_raster(aes(x = LONG, y = LAT, fill = diversification_model_based)) +    scale_fill_carto_c(type = \"quantitative\",                      palette = \"SunsetDark\",                       direction = 1,                       limits = c(0, 1),  ## max percent overall                      breaks = seq(0, 1, by = .25),                      labels = glue::glue(\"{seq(0, 1, by = 0.25)}\")) +   ggplot2::geom_sf(data = coastline, size = 0.4) +   ggplot2::geom_sf(     data = sf.evoregion,      color = rev(col_five_hues),     fill = NA,      size = 0.7) +   ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +   ggplot2::ggtitle(\"C\") +    ggplot2::ggplot2::theme_bw() +   ggplot2::labs(fill = \"In-situ diversification\") +   ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +   ggplot2::theme(     legend.position = \"bottom\",     axis.title = element_blank(),     legend.text = element_text(size = 10),      axis.text = element_text(size = 5),     plot.subtitle = element_text(hjust = 0.5)   )   map_diversification_complete <- map_diversification + map_diversification_model_based"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"historical-dispersal-events","dir":"Articles","previous_headings":"","what":"Historical dispersal events","title":"Introduction to Herodotools","text":"can also calculate importance dispersal events related ancestral range. using function dispersal_from can quantify contribution given ancestral range historical dispersal species assemblage. done calculating proportion species assemblage dispersed focal ancestral range. calculation done accounting species events dispersal ancestral lineage. also can map contribution dispersal regions. Note area ancestral range focused map values dipersal , since source dispersal regions.","code":"akodon_dispersal <-  Herodotools::dispersal_from(W = akodon.pa.tree,                tree = akodon.newick,                 ancestral.area = node.area,                 biogeo = biogeo_area) sites <- dplyr::bind_cols(site.xy,                    site.region =  site.region,                     age = age_comm$mean_age_per_assemblage,                    diversification = akodon_diversification$Jetz_harmonic_mean_site,                    diversification_model_based = akodon_diversification$model_based_Jetz_harmonic_mean_site,                    dispersal.D = akodon_dispersal[,1],                     dispersal.A = akodon_dispersal[, 2],                    dispersal.E = akodon_dispersal[, 3],                    dispersal.BD = akodon_dispersal[, 4],                    dispersal.B = akodon_dispersal[, 5])  map_dispersal_D <-     sites %>%     ggplot2::ggplot() +     ggplot2::geom_raster(aes(x = LONG, y = LAT, fill = dispersal.D)) +        scale_fill_carto_c(      type = \"quantitative\", palette = \"SunsetDark\", na.value = \"white\", limits = c(0,1)      ) +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::geom_sf(      data = sf.evoregion,       color = rev(col_five_hues),      fill = NA,       size = 0.5) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"From D\") +     ggplot2::ggplot2::theme_bw() +    ggplot2::labs(fill = \"% of contribution\") +    ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +    ggplot2::theme(      legend.position = \"bottom\",      axis.title = element_blank(),      legend.text = element_text(size = 10),       axis.text = element_text(size = 5),      plot.subtitle = element_text(hjust = 0.5)       )  map_dispersal_A <-     sites %>%     ggplot2::ggplot() +     ggplot2::geom_raster(aes(x = LONG, y = LAT, fill = dispersal.A)) +        scale_fill_carto_c(      type = \"quantitative\", palette = \"SunsetDark\", na.value = \"white\", limits = c(0,1)      ) +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::geom_sf(      data = sf.evoregion,       color = rev(col_five_hues),      fill = NA,       size = 0.5) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"From A\") +     ggplot2::ggplot2::theme_bw() +    ggplot2::labs(fill = \"% of contribution\") +    ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +    ggplot2::theme(      legend.position = \"bottom\",      axis.title = element_blank(),      legend.text = element_text(size = 10),       axis.text = element_text(size = 5),      plot.subtitle = element_text(hjust = 0.5)       )  map_dispersal_B <-     sites %>%     ggplot2::ggplot() +     ggplot2::geom_raster(aes(x = LONG, y = LAT, fill = dispersal.B)) +    scale_fill_carto_c(      type = \"quantitative\", palette = \"SunsetDark\", na.value = \"white\", limits = c(0,1)      ) +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::geom_sf(      data = sf.evoregion,       color = rev(col_five_hues),      fill = NA,       size = 0.5) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"From B\") +     ggplot2::ggplot2::theme_bw() +    ggplot2::labs(fill = \"% of contribution\") +   ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +    ggplot2::theme(      legend.position = \"bottom\",      axis.title = element_blank(),      legend.text = element_text(size = 10),       axis.text = element_text(size = 5),      plot.subtitle = element_text(hjust = 0.5)       )   map_dispersion_from <-    (map_evoregion + plot_layout(guides = \"keep\")) /    (map_dispersal_A | map_dispersal_B | map_dispersal_D) +   plot_layout(heights = c(1, .75), guides = \"collect\") &   ggplot2::theme(legend.position = \"bottom\")"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"phylomodelmetricscomm","dir":"Articles","previous_headings":"Historical dispersal events","what":"Model based community phylogetic metrics","title":"Introduction to Herodotools","text":"also can calculate common used metrics Community Phylogenetics, now considering macroevolutionary dynamics calculation. model-based community phylogenetic metrics allows disentangle effects situ diversification dispersal metrics can plot PDdb PEdb map","code":"akodon_db_metrics <-  Herodotools::div_based_metrics(W = akodon.pa.tree,                   tree = akodon.newick,                    ancestral.area = node.area,                    biogeo = biogeo_area,                    PD = TRUE,                    PE = TRUE) sites <- dplyr::bind_cols(site.xy,                    site.region =  site.region,                     age = age_comm$mean_age_per_assemblage,                    diversification = akodon_diversification$Jetz_harmonic_mean_site,                    PE = akodon_db_metrics$PE,                     PEdb = akodon_db_metrics$Db_PE,                    PD = akodon_db_metrics$PD,                    PDdb = akodon_db_metrics$PDlocal)  map_PE <-     sites %>%     ggplot2::ggplot() +     ggplot2::geom_raster(aes(x = LONG, y = LAT, fill = PE)) +     scale_fill_carto_c(type = \"quantitative\", palette = \"SunsetDark\") +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::geom_sf(      data = sf.evoregion,       color = rev(col_five_hues),      fill = NA,       size = 0.7) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"PE for Akodon Genus\") +     ggplot2::ggplot2::theme_bw() +    ggplot2::labs(fill = \"PE value\") +     ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +    ggplot2::theme(      legend.position = \"bottom\",      axis.title = element_blank()    )  map_PEdb <-     sites %>%     ggplot2::ggplot() +     ggplot2::geom_raster(aes(x = LONG, y = LAT, fill = PEdb)) +     scale_fill_carto_c(type = \"quantitative\", palette = \"SunsetDark\") +    ggplot2::geom_sf(data = coastline, size = 0.4) +    ggplot2::geom_sf(      data = sf.evoregion,       color = rev(col_five_hues),      fill = NA,       size = 0.7) +    ggplot2::coord_sf(xlim = map_limits$x, ylim = map_limits$y) +    ggplot2::ggtitle(\"PEdb for Akodon Genus\") +     ggplot2::ggplot2::theme_bw() +    ggplot2::labs(fill = \"PEdb value\") +     ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                  direction = \"horizontal\",                                ticks.colour = \"grey20\",                                title.position = \"top\",                                label.position = \"bottom\",                                title.hjust = 0.5)) +    ggplot2::theme(      legend.position = \"bottom\",      axis.title = element_blank()    )  map_PEdb <- map_PE + map_PEdb"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"traitdynamics","dir":"Articles","previous_headings":"","what":"Tip-based metrics of trait evolution","title":"Introduction to Herodotools","text":"show implement three tip-based metrics proposed Luza et al. (2021). Note tip-based metrics estimated using stochastic mapping discrete/categorical traits (diet original publication), can extended traits show . three tip-based metrics Transition rates, Stasis time, Last transition time, implemented function tip_based_trait_evo. Transition rates indicate many times ancestral character changed time. Stasis time indicates maximum branch length (time interval) current tip-character maintained across whole phylogeny. Finally, last transition time sum branch lengths tip prior/previous node reconstructed character equal current tip-character. original publication, use stochastic character mapping discrete trait data. time, however, reconstruct species foraging strata (Elton Traits’ database, Wilman et al. 2014). reconstruct foraging strata 214 sigmodontine rodent species trait phylogenetic data (consensus phylogeny Upham et al. 2019). First load trait phylogenetic data need run function tip_based_trait_evo. Now hand estimates three tip-based metrics 214 rodent species. can summarize tip-based metrics ecological assemblage scale. First load assemblage & geographic data comprising 1770 grid cells located Neotropics. Now calculate values tip-based metrics species assemblage. represent space variation tip-based metrics rodent assemblages. seems , general, assemblages southern, western northeastern Neotropics species higher Transition Rates foraging strata communities elsewhere (.e., many species often changed foraging strata time). Assemblage-level Stasis Time high two groups assemblages: one northeastern Neotropics, another central Amazonia. first group particular also showed high Transition Rates. Taken together, results indicate , despite frequent changes foraging strata, species northeastern assemblages retained phenotipic state time species found elsewhere. Finally, Last Transition Time metric shows transitions leading present species foraging strata older ) north Amazonia ii) central Mexico. results potentially reflecting ) location arrival ancestral sigmodontine rodents south America, ii) occurrence several species closely related basal lineages.","code":"rodent.phylo <- ape::read.nexus(   system.file(\"extdata\", \"Sigmodontinae_285speciesTree.tre\", package = \"Herodotools\")   )    # traits traits <- read.table(   system.file(\"extdata\", \"MamFuncDat.txt\", package = \"Herodotools\"),   header = T, sep = \"\\t\"   )  # adjust sciName for matching traits$Scientific <- gsub (\" \", \"_\", traits$Scientific) traits <- traits[which(traits$Scientific %in% rodent.phylo$tip.label), ] # subset traits <- traits[match(rodent.phylo$tip.label,traits$Scientific), ] # match to have the same order traits <- traits[is.na(traits$Scientific) !=T,] #names not matching rownames(traits) <- traits$Scientific  # match match_data <- picante::match.phylo.data(rodent.phylo, traits)  trait <- match_data$data$ForStrat.Value names(trait) <- match_data$data$Scientific  # run function trans_rates <- tip_based_trait_evo(tree = match_data$phy,                                    trait = trait , # need to be named to work                                    nsim = 50,                                    method = c(\"transition_rates\", \"last_transition_time\", \"stasis_time\")) # load community data comm.data <- read.table(    system.file(\"extdata\", \"PresAbs_228sp_Neotropical_MainDataBase_Ordenado.txt\",                 package = \"Herodotools\"),    header = T, sep = \"\\t\"    )  # load latlong of these communities geo.data <- read.table(   system.file(\"extdata\", \"Lon-lat-Disparity.txt\", package = \"Herodotools\"),   header = T, sep = \"\\t\"   ) # transition rates for each community averaged_rates <- purrr::map_dfr(1:nrow(comm.data), function (i){   # across assemblages   purrr::map_dfr(trans_rates, function (sims) { # across simulations          # species in the assemblages     gather_names <- names(comm.data[i,][which(comm.data[i,]>0)]) # get the names     # subset of rates     rates <- sims[which(rownames (sims) %in% gather_names),                    c(\"prop.transitions\",                       \"stasis.time\",                      \"last.transition.time\")]     mean_rates <- apply(rates, 2, mean) # and calculate the average     mean_rates   }) %>%      purrr::map(mean) }) # prepare data to map data_to_map_wide <- data.frame(geo.data[,c(\"LONG\", \"LAT\")], averaged_rates)  data_to_map_long <-    data_to_map_wide %>%    tidyr::pivot_longer(     cols = 3:5,     names_to = \"variables\",     values_to = \"values\"   )  # create a list with the maps list_map_transitions <- lapply(unique(data_to_map_long$variables), function(metric){      plot.title <- switch(     metric,     \"prop.transitions\" = \"Transition Rates\",     \"stasis.time\" = \"Stasis Time\",     \"last.transition.time\" = \"Last Transition Time\"   )      sel_data <-      data_to_map_long %>%      dplyr::filter(variables == metric)      var_range <- range(sel_data$values) %>% round(2)   var_breaks <- seq(var_range[1], var_range[2], diff(var_range/4)) %>% round(2)      sig_map_limits <- list(     x = range(sel_data$LONG),      y = range(sel_data$LAT)   )      ggplot() +     ggplot2::geom_raster(data = sel_data,                  aes(x = LONG, y = LAT, fill = values)) +     rcartocolor::scale_fill_carto_c(       type = \"quantitative\",        palette = \"SunsetDark\",        na.value = \"white\",        limits = var_range,        breaks = var_breaks     )+      ggplot2::geom_sf(data = coastline, size = 0.4) +     ggplot2::coord_sf(xlim = sig_map_limits$x, ylim = sig_map_limits$y) +     ggplot2::ggplot2::theme_bw() +     ggplot2::guides(fill = guide_colorbar(barheight = unit(2.3, units = \"mm\"),                                    direction = \"horizontal\",                                  ticks.colour = \"grey20\",                                  title.position = \"top\",                                  label.position = \"bottom\",                                  title.hjust = 0.5)) +     ggplot2::labs(title = plot.title) +     ggplot2::theme(       legend.position = \"bottom\",       axis.title = element_blank(),       legend.title = element_blank(),       legend.text = element_text(size = 10),        axis.text = element_text(size = 5),       plot.subtitle = element_text(hjust = 0.5)        )    })  # Create map mapTransition_rate <- patchwork::wrap_plots(list_map_transitions) +   patchwork::plot_annotation(tag_levels = \"A\")"},{"path":"https://gabrielnakamura.github.io/Herodotools/articles/Intro_Herodotools_vignette.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Introduction to Herodotools","text":"Luza, . L., Maestri, R., Debastiani, V. J., Patterson, B. D., Maria, S., & Leandro, H. (2021). evolution faster ecotones? test using rates tempo diet transitions Neotropical Sigmodontinae ( Rodentia , Cricetidae ). Ecology Evolution, December, 18676–18690. https://doi.org/10.1002/ece3.8476 Maestri, R., & Duarte, L. D. S. (2020). Evoregions: Mapping shifts phylogenetic turnover across biogeographic regions Renan Maestri. Methods Ecology Evolution, 2020(August), 1652–1662. https://doi.org/10.1111/2041-210X.13492 Pigot, . Etienne, R. (2015). new dynamic null model phylogenetic community structure. Ecology Letters, 18(2), 153-163. https://doi.org/10.1111/ele.12395 Van Dijk, ., Nakamura, G., Rodrigues, . V., Maestri, R., & Duarte, L. (2021b). Imprints tropical niche conservatism historical dispersal radiation Tyrannidae (Aves: Passeriformes). Biological Journal Linnean Society, 134(1), 57–67. https://doi.org/10.1093/biolinnean/blab079","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gabriel Nakamura. Author, maintainer. Arthur Rodrigues. Author. André Luza. Author.            O-1134-2017 Vanderlei Debastiani. Author. Renan Maestri. Author. Leandro Duarte. Author.            B-6552-2012","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Nakamura G, Rodrigues , Luza , Debastiani V, Maestri R, Duarte L (2022). Herodotools: Tools Historical Biogeography analysis. R package version 0.0.1, https://gabrielnakamura.github.io/Herodotools/.","code":"@Manual{,   title = {Herodotools: Tools for Historical Biogeography analysis},   author = {Gabriel Nakamura and Arthur Rodrigues and André Luza and Vanderlei Debastiani and Renan Maestri and Leandro Duarte},   year = {2022},   note = {R package version 0.0.1},   url = {https://gabrielnakamura.github.io/Herodotools/}, }"},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/index.html","id":"general-overview","dir":"","previous_headings":"","what":"General overview","title":"Tools for Historical Biogeography analysis","text":"Herodotools R package allows perform analysis investigate effects historical processes, specifically diversification historical dispersal, determine biodiversity structure assemblages biogeographical regions. achieved integrating tools macroevolutionary dynamics (e.g. ancestral area reconstruction, trait reconstruction) metrics commonly used community phylogenetics, also providing new metrics integrate macroevolutionary dynamics assemblage biogeographical scales. functions presented Herodotools package used previous studies understand, example, imprints historical processes present day patterns diversity, macroecological patterns interplay effects ecological variation macroevolutionary dynamics general, Herodotools designed work unified platform analysis historical biogeography integrating methods Macroecology, Macroevolution Community Phylogenetics.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/index.html","id":"download","dir":"","previous_headings":"","what":"Download","title":"Tools for Historical Biogeography analysis","text":"install development version package user must type:","code":"# install.packages(\"devtools\") devtools::install_github(\"GabrielNakamura/Herodotools\", ref = \"main\")"},{"path":"https://gabrielnakamura.github.io/Herodotools/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Tools for Historical Biogeography analysis","text":"details examples please visit Herodotools web page","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"Tools for Historical Biogeography analysis","text":"Gabriel Nakamura, Arthur Rodrigues, André Luza, Renan Maestri, Vanderlei Debastiani Leandro Duarte","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ada.html","id":null,"dir":"Reference","previous_headings":"","what":"Ancestral Diversity Analysis — ada","title":"Ancestral Diversity Analysis — ada","text":"function computes different assemblage level metrics using ancestral community reconstruction","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ada.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ancestral Diversity Analysis — ada","text":"","code":"ada(   x,   phy,   sp.bin = \"Sturges\",   marginal = FALSE,   lik.threshold = FALSE,   threshold = 0.7,   compute.fields = F )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ada.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ancestral Diversity Analysis — ada","text":"x Community occurrence matrix. Rows sites columns species phy Phylogenetic tree sp.bin Character indicating methods used compute number time slices metrics computed. Default \"Sturges\" marginal Logical indicating lik.threshold Logical indicating threshold value used select likelihood values ancestor species site. Default TRUE threshold Scalar indicating threshold value used select likelihood given species present site compute.fields Logical, indicates phylogenetic fields computed. Default FALSE","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ada.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ancestral Diversity Analysis — ada","text":"list size eight containing following objects Phylogeny Phylogenetic tree Root.Age Numeric containing root age tree used Per.node.ancestral.area Matrix containing ancestors (nodes) species Diversity..Time Age node phylogeny Cell.Metric Matrix containing assemblage level metrics richness ancestral diversity","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ada.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ancestral Diversity Analysis — ada","text":"ada function calculates ancestral assemblage reconstruction assemblage matrix using reconstruction ace function ape package","code":""},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/affiliation_evoreg.html","id":null,"dir":"Reference","previous_headings":"","what":"Affiliation of assemblages based on phylogenetic turnover — affiliation_evoreg","title":"Affiliation of assemblages based on phylogenetic turnover — affiliation_evoreg","text":"Affiliation assemblages based phylogenetic turnover","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/affiliation_evoreg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Affiliation of assemblages based on phylogenetic turnover — affiliation_evoreg","text":"","code":"affiliation_evoreg(phylo.comp.dist, groups)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/affiliation_evoreg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Affiliation of assemblages based on phylogenetic turnover — affiliation_evoreg","text":"phylo.comp.dist distance matrix indicating phylogenetic (taxonomic/functional) distance composition among assemblages groups character vector indicating group assemblage. object can obtained evoregions","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/affiliation_evoreg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Affiliation of assemblages based on phylogenetic turnover — affiliation_evoreg","text":"list two matrix, one containing affiliation values group cell classified containing cell coordinates","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/affiliation_evoreg.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Affiliation of assemblages based on phylogenetic turnover — affiliation_evoreg","text":"function calculates degree affiliation community region (evoregion), community classified. used coupled analysis Principal Coordinates Phylogenetic Structure (PCPS) represent phylogenetic distances analysis output analysis represent degree membership assemblages evoregion, described Maestri Duarte 2020.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/affiliation_evoreg.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Affiliation of assemblages based on phylogenetic turnover — affiliation_evoreg","text":"Maestri, R Duarte L.d.S. (2020). Evoregions: Mapping shifts phylogenetic turnover across biogeographic regions. Methods Ecology Evolution, 11, 1652-1662.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/affiliation_evoreg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Affiliation of assemblages based on phylogenetic turnover — affiliation_evoreg","text":"","code":"if (FALSE) { # First run the classification data(akodon.pa.tree) # occurrence data  data(akodon.newick) # phylogenetic tree regions <- evoregions(comm = akodon.pa.tree, phy = akodon.newick) site.region <- regions$Cluster_Evoregions # classification of each community in regions  # Now use the phylogenetic composition (PCPS) and classification obtained from evoregion to calculate the membership axis_sel <- which(regions$PCPS$prop_explainded >= regions$PCPS$tresh_dist) # selecting only significant PCPS axis PCPS_thresh <- regions$PCPS$vectors[, axis_sel] # only significant axis dist_phylo_PCPS <- vegan::vegdist(PCPS_thresh, method = \"euclidean\") # distance matrix based on phylogenetic structure affiliation_evoreg(phylo.comp.dist = dist_phylo_PCPS,groups = regions$Cluster_Evoregions) # affiliation }"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/age_arrival.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes the arrival ages of each species in the assemblages — age_arrival","title":"Computes the arrival ages of each species in the assemblages — age_arrival","text":"Computes arrival ages species assemblages","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/age_arrival.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes the arrival ages of each species in the assemblages — age_arrival","text":"","code":"age_arrival(W, tree, ancestral.area, biogeo, age.no.ancestor = \"recent\")"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/age_arrival.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes the arrival ages of each species in the assemblages — age_arrival","text":"W Occurrence matrix, rows assemblages columns species tree Phylogenetic tree newick format ancestral.area One column data frame, nodes row one column containing occurrence nodes biogeo One column data frame, assemblages rows one column containing region assemblage located age..ancestor character string \"recent\" (default) \"half.edge\" indicating deal cases recent aancestor tip node region. \"recent\" attributes small age (10e-5), \"half.edge\" attributes age half length branch linking ancestor tip.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/age_arrival.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes the arrival ages of each species in the assemblages — age_arrival","text":"list length two. age_arrival matrix arrival age species assemblage mean_age_arrival mean age values assemblage","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/age_arrival.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Computes the arrival ages of each species in the assemblages — age_arrival","text":"function computes mean arrival age species assemblage based ancestral area reconstruction. assemblage calculate arrival establishment ancestor present-day species showed Van Dijk et al (2021). consider arrival event arrival ancestor establishment ancestor present day. Arrival events occurred last speciation event lineage present time can assigned small value age corresponding half lenght branch linking ancestor present day species","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/age_arrival.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Computes the arrival ages of each species in the assemblages — age_arrival","text":"Van Dijk, .; Nakamura G,; Rodrigues, .V.; Maestri, R. Duarte, L.d.S. (2021). Imprints tropical niche conservatism historical dispersal radiation Tyrannidae (Aves:Passeriformes). Biol. Journ. Linnean Soc., 134, 57-67.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/age_arrival.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Computes the arrival ages of each species in the assemblages — age_arrival","text":"Gabriel Nakamura gabriel.nakamura.souza@gmail.com Arthur Rodrigues","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/age_arrival.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computes the arrival ages of each species in the assemblages — age_arrival","text":"","code":"# hypothetical occurrence matrix with species in columns and assemblages in lines  W_toy<- matrix(c(0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0),nrow= 3,ncol= 5,dimnames=list(c(\"Comm 1\", \"Comm 2\", \"Comm 3\"),c(paste(\"s\", 1:5, sep=\"\"))))    # hypothetical data indicating the ecoregions of each assemblage  biogeo_toy <- data.frame(Ecoregion= c(\"A\", \"B\", \"C\"))    # hypothetical data indicating the ancestral range of each node  ancestral_area_toy <- data.frame(state= c(\"ABC\", \"B\", \"C\", \"ABC\"))    # caculating age of each assemblage  age_assemblages <- age_arrival(W_toy, toy_treeEx, ancestral_area_toy, biogeo_toy)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ancestral_state.html","id":null,"dir":"Reference","previous_headings":"","what":"Ancestral State per Assemblage — ancestral_state","title":"Ancestral State per Assemblage — ancestral_state","text":"Ancestral State per Assemblage","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ancestral_state.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ancestral State per Assemblage — ancestral_state","text":"","code":"ancestral_state(tree, ancestral.area, prefix = \"N\")"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ancestral_state.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ancestral State per Assemblage — ancestral_state","text":"tree newick phylogenetic tree object ancestral.area One column data frame. Lines nodes column biomes/region occurrence ancestors. Can obtained using (get_node_range_BioGeoBEARS) prefix single character string used name nodes","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ancestral_state.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ancestral State per Assemblage — ancestral_state","text":"data frame assemblages lines nodes columns. cell contains ancestral area/Ecoregion occurrence node respective species.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ancestral_state.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Ancestral State per Assemblage — ancestral_state","text":"Gabriel Nakamura gabriel.nakamura.souza@gmail.com","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/ancestral_state.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ancestral State per Assemblage — ancestral_state","text":"","code":"biogeo_toy <- data.frame(Ecoregion= c(\"A\", \"B\", \"C\")) ancestral_area_toy <- data.frame(state= c(\"ABC\", \"B\", \"C\", \"ABC\")) ancestral_state(toy_treeEx, ancestral_area_toy) #>    s1    s2    s3    s4    s5    #> N6 \"ABC\" \"ABC\" \"ABC\" \"ABC\" \"ABC\" #> N7 \"B\"   \"B\"   \"B\"   NA    NA    #> N8 \"C\"   \"C\"   NA    NA    NA    #> N9 NA    NA    NA    \"ABC\" \"ABC\""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/db_diversification.html","id":null,"dir":"Reference","previous_headings":"","what":"Tip-based and model-based diversification metrics — db_diversification","title":"Tip-based and model-based diversification metrics — db_diversification","text":"Tip-based model-based diversification metrics","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/db_diversification.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tip-based and model-based diversification metrics — db_diversification","text":"","code":"db_diversification(   W,   tree,   ancestral.area,   biogeo,   diversification = \"jetz\",   type = \"equal.splits\" )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/db_diversification.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tip-based and model-based diversification metrics — db_diversification","text":"W Assemblage occurrence matrix, rows assemblages columns species tree Phylogenetic tree newick format ancestral.area One column data frame indicating Ecoregion occurrence node (rows) biogeo Data frame one column indicating Ecoregion assemblage diversification Character indicating tip-based diversification metric calculated. Default \"jetz\" type Character indicating type calculation used calculation tip-based metric, \"equal-splits\" default","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/db_diversification.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tip-based and model-based diversification metrics — db_diversification","text":"list following objects: Jetz_per_sppJetz tip-based metric diversification species Jetz_species_siteMatrix containing values Jetz tip-based diversification metric assemblage Jetz_harmonic_mean_siteHarmonic mean Jetz tip-based diversification metric model_based_Jetz_species_sitesMatrix model-based Jetz metric species assemblage model_based_Jetz_harmonic_mean_siteHarmonic mean model-based Jetz diversification","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/db_diversification.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Tip-based and model-based diversification metrics — db_diversification","text":"model-based measure diversification calculated proportion total tip-based diversification metric corresponded branches given species diversified current area occurrence species $$Jetz_total \\times (ED_div/ED_total)$$","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/db_diversification.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tip-based and model-based diversification metrics — db_diversification","text":"Gabriel Nakamura gabriel.nakamura.souza@gmail.com Arthur V Rodrigues","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/db_diversification.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Tip-based and model-based diversification metrics — db_diversification","text":"","code":"if (FALSE) { data(akodon.pa.tree) # Occurrence matrix data(akodon.newick) # phylogenetic tree data(resDEC) # output from ancestral area reconstruction performed with BioGeoBEARS data(regions) # ecoregion/evoregion for each assemblage node.area <- get_node_range_BioGeoBEARS(resDEC,phyllip.file = here(\"inst\", \"extdata\", \"geo_area_akodon.data\"),akodon.newick,max.range.size = 4) db_diversification(W=akodon.pa.tree, tree=akodon.newick,ancestral.area=node.area,biogeo=regions) # model based diversification analysis with default options }"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/dispersal_from.html","id":null,"dir":"Reference","previous_headings":"","what":"Proportional contribution of an ancestral area to the species in other region — dispersal_from","title":"Proportional contribution of an ancestral area to the species in other region — dispersal_from","text":"species present site, function calculates proportional contribution ancestral areas dispersal lineage site's region.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/dispersal_from.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Proportional contribution of an ancestral area to the species in other region — dispersal_from","text":"","code":"dispersal_from(W, tree, ancestral.area, biogeo)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/dispersal_from.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Proportional contribution of an ancestral area to the species in other region — dispersal_from","text":"W Occurrence matrix, rows assemblages columns species tree Phylogenetic tree newick format ancestral.area One column data frame nodes rows one column indicating occurrence (biome/ecoregion) area nodes biogeo One column data frame assemblages rows respective biome/ecoregion","code":""},{"path":[]},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/dispersal_from.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Proportional contribution of an ancestral area to the species in other region — dispersal_from","text":"Arthur V Rodrigues rodrigues.arthur.v@gmail.com","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/dispersal_from.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Proportional contribution of an ancestral area to the species in other region — dispersal_from","text":"","code":"if (FALSE) { data(akodon.sites) # occurrence matrix data(akodon.pa.tree) # phylogenetic tree data(regions) # biogeographic region data(resDEC) # output from ancestral area reconstruction node.area <- get_node_range_BioGeoBEARS(resDEC,phyllip.file = here(\"inst\", \"extdata\", \"geo_area_akodon.data\"),akodon.newick,max.range.size = 4) # data frame indicating the ancestral area occurrence dispersal_from(W=akodon.sites,tree=akodon.pa.tree,ancestral.area=node.area,biogeo=regions) # historical dispersal analysis }"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/div_based_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Diversification-based PD and PE — div_based_metrics","title":"Diversification-based PD and PE — div_based_metrics","text":"Diversification-based PD PE","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/div_based_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Diversification-based PD and PE — div_based_metrics","text":"","code":"div_based_metrics(W, tree, ancestral.area, biogeo, PD = TRUE, PE = TRUE)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/div_based_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Diversification-based PD and PE — div_based_metrics","text":"W Occurrence matrix, rows assemblages columns species tree Phylogenetic hipothesis newick format ancestral.area One column data frame nodes rows one column indicating occurrence area nodes biogeo One columns data frame rows indicating assemblages one column indicating biome/ecoregion assemblage PD Logical, TRUE (default) Db-PD computed PE Logical, TRUE (default) Db-PE computed","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/div_based_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Diversification-based PD and PE — div_based_metrics","text":"data frame containing values original PD PE also model based version","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/div_based_metrics.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Diversification-based PD and PE — div_based_metrics","text":"function computes two modified versions Phylogenetic Diversity (PD) Phylogenetic endemism considering calculation -situ diversification. Db-PD Db-PE calculated coupling calculation ancetral area reconstruction divide phylogenetic tree two parts, one correspond dispersion events another correspond -situ diversification events. use -situ diversification part calculate Db-PD Db-PE","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/div_based_metrics.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Diversification-based PD and PE — div_based_metrics","text":"Gabriel Nakamura gabriel.nakamura.souza@gmail.com","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/div_based_metrics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Diversification-based PD and PE — div_based_metrics","text":"","code":"if (FALSE) { W_toy<- matrix(c(0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0), nrow= 3, ncol= 5, dimnames=list(c(\"Comm 1\", \"Comm 2\", \"Comm 3\"), c(paste(\"s\", 1:5, sep=\"\"))))    biogeo_toy <- data.frame(Ecoregion= c(\"A\", \"B\", \"C\"))  ancestral_area_toy <- data.frame(state= c(\"ABC\", \"B\", \"C\", \"ABC\"))  assemblage_phylo_metrics <- div_based_metrics(W_toy, toy_treeEx, ancestral_area_toy, biogeo_toy)  }"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/evoregions.html","id":null,"dir":"Reference","previous_headings":"","what":"Defining biogeographic regions based on phylogenetic turnover — evoregions","title":"Defining biogeographic regions based on phylogenetic turnover — evoregions","text":"Defining biogeographic regions based phylogenetic turnover","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/evoregions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Defining biogeographic regions based on phylogenetic turnover — evoregions","text":"","code":"evoregions(   comm,   phy,   max.n.clust = NULL,   method.dist = \"bray\",   tresh.dist = 0.05,   method.clust = \"kmeans\",   stat.clust = \"BIC\",   n.iter.clust = 1e+07,   criterion.clust = \"diffNgroup\" )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/evoregions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Defining biogeographic regions based on phylogenetic turnover — evoregions","text":"comm Species occurrence matrix. Assemblages rows species columns phy phylogenetic tree class phylo containing species comm. max.n.clust Integer value used find.clusters. Indicates maximum number clusters tried. method.dist Character. method used compute phyogenetic distances among assemblages. Dissimilarity index, accepted vegdist (Default \"bray\"). tresh.dist scalar informing threshold value select eigenvectors based amount variation eigenvector. Default 0.05 (eigenvector least 5% variation). See details. method.clust Character indicating grouping algorithm used cluster analysis. Options avalible \"kmeans\" (default) \"ward\". stat.clust Character used find.clusters indicating statistic computed model. Can \"BIC\" (default), \"AIC\" \"WSS\". n.iter.clust Integer used find.clusters function adegenet package indicate number iterations used run K-means algorithm","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/evoregions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Defining biogeographic regions based on phylogenetic turnover — evoregions","text":"list length four containing: PCPS_vectors matrix PCPS vectors Cluster_Evoregion vector indicating region assemblage classified","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/evoregions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Defining biogeographic regions based on phylogenetic turnover — evoregions","text":"evoregions performs biogeographical regionalization analysis, differently methods, evoregion uses phylogenetic turnover metric based fuzzy sets, therefore accounting characteristics evolutionary history, e.g tree imbalance, accounted metrics phylogenetic turnover.","code":""},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/find_max_nclust.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate the maximum number of groups in DAPC analysis — find_max_nclust","title":"Estimate the maximum number of groups in DAPC analysis — find_max_nclust","text":"Estimate maximum number groups DAPC analysis","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/find_max_nclust.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate the maximum number of groups in DAPC analysis — find_max_nclust","text":"","code":"find_max_nclust(   x,   threshold,   max.nclust,   nperm = 100,   method = \"kmeans\",   stat = \"BIC\",   criterion = \"diffNgroup\",   subset = 100,   confidence.level = c(0.7, 0.8, 0.9, 0.95, 0.99) )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/find_max_nclust.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate the maximum number of groups in DAPC analysis — find_max_nclust","text":"x data.frame matrix object containing eigenvectors sites. threshold Scalar. number eigenvectors used perform classification. max.nclust Value set values defining maximum number groups evaluated. nperm Scalar. Number times classification performed. method c(\"kmeans\",\"ward\"). See find.clusters adegenet package. stat c(\"BIC\", \"AIC\", \"WSS\"). See find.clusters adegenet package. criterion c(\"diffNgroup\", \"min\",\"goesup\", \"smoothNgoesup\", \"goodfit\"). See find.clusters adegenet package. subset number cells used analysis. particularly important whenever total number cells large (> 1000). confidence.level threshold confidence level used estimate congruence classification pattern.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/find_max_nclust.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate the maximum number of groups in DAPC analysis — find_max_nclust","text":"Matrix containing congruence values ranging 0-1 max.nclust value (see Arguments) confidence level.","code":""},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_node_range_BioGeoBEARS.html","id":null,"dir":"Reference","previous_headings":"","what":"Get node ranges from BioGeoBEARS biome reconstruction model — get_node_range_BioGeoBEARS","title":"Get node ranges from BioGeoBEARS biome reconstruction model — get_node_range_BioGeoBEARS","text":"auxiliary function can ancestral area reconstruction BioGeoBEARS obtain data frame containing ancestral area occurrence (biome range) ancestors (nodes)","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_node_range_BioGeoBEARS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get node ranges from BioGeoBEARS biome reconstruction model — get_node_range_BioGeoBEARS","text":"","code":"get_node_range_BioGeoBEARS(   BioGeoBEARS.data,   phyllip.file,   tree,   max.range.size )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_node_range_BioGeoBEARS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get node ranges from BioGeoBEARS biome reconstruction model — get_node_range_BioGeoBEARS","text":"BioGeoBEARS.data object containing result BioGeoBEARS reconstruction phyllip.file Phylip file, used BioGeoBEARS package tree phylogenetic tree max.range.size Scalar indicating maximum number biomes node can occupy","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_node_range_BioGeoBEARS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get node ranges from BioGeoBEARS biome reconstruction model — get_node_range_BioGeoBEARS","text":"Data frame two columns, one indicating node ancestral biome range","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/get_node_range_BioGeoBEARS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get node ranges from BioGeoBEARS biome reconstruction model — get_node_range_BioGeoBEARS","text":"","code":"data(resDEC) # ancestral area reconstruction from biogeobears data(akodon.newick) extdata_dir = system.file(\"extdata\", package=\"Herodotools\") fn = paste(extdata_dir, \"/geo_area_akodon.data\", sep=\"\") node.area <- get_node_range_BioGeoBEARS(resDEC,phyllip.file = fn, akodon.newick,  max.range.size = 4) # obtaining area for each node"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/nodes_info_core.html","id":null,"dir":"Reference","previous_headings":"","what":"Auxiliary function to compute information of node path and dispersal path for each species — nodes_info_core","title":"Auxiliary function to compute information of node path and dispersal path for each species — nodes_info_core","text":"Auxiliary function compute information node path dispersal path species","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/nodes_info_core.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Auxiliary function to compute information of node path and dispersal path for each species — nodes_info_core","text":"","code":"nodes_info_core(W, tree, ancestral.area, biogeo)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/nodes_info_core.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Auxiliary function to compute information of node path and dispersal path for each species — nodes_info_core","text":"W Numerical matrix, rows assemblages columns species tree Phylogenetic tree newick format ancestral.area Single column data frame nodes rows ancestral area/Ecoregion occurrence columns. reconstruction comes BioGeoBears data frame can obtained (get_node_range_BioGeoBEARS) biogeo Data frame containing information biome/area/ecoregion assemblage","code":""},{"path":[]},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/plot_ada.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotting ancestral area character in space — plot_ada","title":"Plotting ancestral area character in space — plot_ada","text":"Plotting ancestral area character space","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/plot_ada.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotting ancestral area character in space — plot_ada","text":"","code":"plot_ada(   ada.res,   grid,   coords,   resolution,   patterns = \"all\",   color_palette = \"SunsetDark\",   projection = \"+proj=robin\" )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/plot_ada.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotting ancestral area character in space — plot_ada","text":"ada.res object ada function grid spatial object containing cells used calculate ancestral diversity distribution ada coords two column matrix containing values Longitude (first column) Latitude (second column) resolution Scalar informing resolution grids grid object patterns Character, vector containing names metrics spatialized \"\" create map metrics.  characters allowed passed \"rich\", \"Nnodes\", \"PeakDiv\", \"Skewness\", \"LowDistPeak\", \"HighDistPeak\", \"PeakRange\". Default \"\" color_palette Character indicating palette used plot spatial patterns. can one option present scale_fill_carto_c function. Default \"SunsetDark\" projection Character indicating projection used spatial plots. Default \"+proj=robin\"","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/plot_ada.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plotting ancestral area character in space — plot_ada","text":"list containing spatial plots metrics calculated ada.res","code":""},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/region_occ.html","id":null,"dir":"Reference","previous_headings":"","what":"Species occurrence in each evoregion — region_occ","title":"Species occurrence in each evoregion — region_occ","text":"Auxiliary function produce occurrence data frame species region. object can tipranges_to_BioGeoBEARS function produce phyllip file needed BioGeoBEARS ancestral area reconstruction","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/region_occ.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Species occurrence in each evoregion — region_occ","text":"","code":"region_occ(comm, site.region)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/region_occ.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Species occurrence in each evoregion — region_occ","text":"comm Occurrence data frame species colums rows corresponding assemblages site.region character vector indicating membership assemblage regions","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/region_occ.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Species occurrence in each evoregion — region_occ","text":"occurrence data frame species rownames regions columns","code":""},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/region_occ.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Species occurrence in each evoregion — region_occ","text":"Gabriel Nakamura Arthur Rodrigues","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/region_occ.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Species occurrence in each evoregion — region_occ","text":"","code":"data(akodon.pa.tree) data(regions) site_evoregion <- regions$Cluster_Evoregions region_occ(comm=akodon.pa.tree,site.region=site_evoregion) #>               A B C D E F G H I #> A_aerosus     1 1 0 0 0 0 0 0 0 #> A_affinis     0 1 0 0 0 0 0 0 0 #> A_albiventer  1 1 0 0 0 0 0 0 0 #> A_azarae      0 0 1 0 0 1 0 0 1 #> A_boliviensis 1 0 0 0 0 0 0 0 0 #> A_budini      1 0 0 0 0 0 0 0 0 #> A_cursor      0 0 0 0 0 0 0 1 0 #> A_dayi        1 0 0 1 0 0 0 0 0 #> A_dolores     0 0 1 1 0 0 0 0 0 #> A_fumeus      1 0 0 0 0 0 0 0 0 #> A_iniscatus   0 0 0 1 1 0 0 0 0 #> A_juninensis  1 0 0 0 0 0 0 0 1 #> A_kofordi     1 0 0 0 0 0 0 0 0 #> A_lindberghi  1 0 0 0 0 0 0 1 0 #> A_lutescens   1 0 0 0 0 0 0 0 0 #> A_mimus       1 0 0 0 0 0 0 0 0 #> A_mollis      0 1 0 0 0 0 0 0 0 #> A_montensis   0 0 0 0 0 0 0 1 0 #> A_mystax      0 0 0 0 0 0 0 1 0 #> A_orophilus   0 1 0 0 0 0 0 0 0 #> A_paranaensis 0 0 0 0 0 1 0 1 0 #> A_reigi       0 0 0 0 0 1 0 0 0 #> A_siberiae    1 0 0 0 0 0 0 0 0 #> A_simulator   1 0 0 0 0 0 0 0 0 #> A_spegazzinii 1 0 1 0 0 0 0 0 0 #> A_subfuscus   1 0 0 0 0 0 0 0 0 #> A_sylvanus    1 0 0 0 0 0 0 0 0 #> A_toba        0 0 1 0 0 0 1 0 0 #> A_torques     1 0 0 0 0 0 0 0 0 #> A_varius      1 0 0 0 1 0 0 0 0"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/spp_association_evoreg.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantifying species association with evoregions — spp_association_evoreg","title":"Quantifying species association with evoregions — spp_association_evoreg","text":"Quantifying species association evoregions","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/spp_association_evoreg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantifying species association with evoregions — spp_association_evoreg","text":"","code":"spp_association_evoreg(comm, evo.vectors, spp.association = 0.7)"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/spp_association_evoreg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantifying species association with evoregions — spp_association_evoreg","text":"comm matrix assemblages rows species columns evo.vectors list returned evoregions function spp.association scalar indicating level association evaluated. Default 0.7","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/spp_association_evoreg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantifying species association with evoregions — spp_association_evoreg","text":"matrix species association value assemblage","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/spp_association_evoreg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantifying species association with evoregions — spp_association_evoreg","text":"","code":"if (FALSE) { data(akodon.pa.tree) # occurrence data  data(akodon.newick) # phylogenetic tree regions <- evoregions(comm = akodon.pa.tree, phy = akodon.newick) # compute evoregions spp_association_evoreg(comm = akodon.pa.tree, evo.vectors = regions, spp.association = 0.7) # calculate species association }"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/spp_nodes.html","id":null,"dir":"Reference","previous_headings":"","what":"Species and their respective ancestral nodes — spp_nodes","title":"Species and their respective ancestral nodes — spp_nodes","text":"function computes matrix containing species respective ancestral nodes","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/spp_nodes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Species and their respective ancestral nodes — spp_nodes","text":"","code":"spp_nodes(tree, node.prefix = \"N\")"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/spp_nodes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Species and their respective ancestral nodes — spp_nodes","text":"tree Phylogenetic tree node.prefix Character indicating prefix used name nodes, default letter \"N\"","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/spp_nodes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Species and their respective ancestral nodes — spp_nodes","text":"matrix species lines nodes columns. 1 indicates node corresponds ancestor species zero indicates species share ancestor node","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/spp_nodes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Species and their respective ancestral nodes — spp_nodes","text":"auxiliary function , taking phylogenetic tree, allows represent matrix format relationship present-day species (tips) ancestors (nodes). function provides easy way obtain certain objects can used functions, like ancestral_state","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/spp_nodes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Species and their respective ancestral nodes — spp_nodes","text":"","code":"data(akodon.newick) spp_nodes(tree = akodon.newick, node.prefix = \"N\") #>     A_mimus A_lindberghi A_subfuscus A_lutescens A_sylvanus A_boliviensis #> N31       1            1           1           1          1             1 #> N32       0            1           1           1          1             1 #> N33       0            1           1           1          1             1 #> N34       0            0           1           1          1             1 #> N35       0            0           1           1          1             1 #> N36       0            0           1           1          1             1 #> N37       0            0           1           1          1             1 #> N38       0            0           1           1          0             0 #> N39       0            0           0           0          1             1 #> N40       0            0           0           0          0             1 #> N41       0            0           0           0          0             0 #> N42       0            0           0           0          0             0 #> N43       0            0           0           0          0             0 #> N44       0            0           0           0          0             0 #> N45       0            0           0           0          0             0 #> N46       0            0           0           0          0             0 #> N47       0            0           0           0          0             0 #> N48       0            0           0           0          0             0 #> N49       0            0           0           0          0             0 #> N50       0            0           0           0          0             0 #> N51       0            0           0           0          0             0 #> N52       0            0           0           0          0             0 #> N53       0            0           0           0          0             0 #> N54       0            0           0           0          0             0 #> N55       0            0           0           0          0             0 #> N56       0            0           0           0          0             0 #> N57       0            0           0           0          0             0 #> N58       0            0           0           0          0             0 #> N59       0            0           0           0          0             0 #>     A_spegazzinii A_azarae A_fumeus A_kofordi A_juninensis A_cursor A_montensis #> N31             1        1        1         1            1        1           1 #> N32             1        1        1         1            1        1           1 #> N33             1        1        1         1            1        1           1 #> N34             1        1        1         1            1        1           1 #> N35             1        1        1         1            1        0           0 #> N36             1        1        0         0            0        0           0 #> N37             1        0        0         0            0        0           0 #> N38             0        0        0         0            0        0           0 #> N39             1        0        0         0            0        0           0 #> N40             1        0        0         0            0        0           0 #> N41             0        0        1         1            1        0           0 #> N42             0        0        1         1            0        0           0 #> N43             0        0        0         0            0        1           1 #> N44             0        0        0         0            0        0           1 #> N45             0        0        0         0            0        0           0 #> N46             0        0        0         0            0        0           0 #> N47             0        0        0         0            0        0           0 #> N48             0        0        0         0            0        0           0 #> N49             0        0        0         0            0        0           0 #> N50             0        0        0         0            0        0           0 #> N51             0        0        0         0            0        0           0 #> N52             0        0        0         0            0        0           0 #> N53             0        0        0         0            0        0           0 #> N54             0        0        0         0            0        0           0 #> N55             0        0        0         0            0        0           0 #> N56             0        0        0         0            0        0           0 #> N57             0        0        0         0            0        0           0 #> N58             0        0        0         0            0        0           0 #> N59             0        0        0         0            0        0           0 #>     A_reigi A_paranaensis A_mystax A_aerosus A_affinis A_mollis A_orophilus #> N31       1             1        1         1         1        1           1 #> N32       1             1        1         1         1        1           1 #> N33       1             1        1         0         0        0           0 #> N34       1             1        1         0         0        0           0 #> N35       0             0        0         0         0        0           0 #> N36       0             0        0         0         0        0           0 #> N37       0             0        0         0         0        0           0 #> N38       0             0        0         0         0        0           0 #> N39       0             0        0         0         0        0           0 #> N40       0             0        0         0         0        0           0 #> N41       0             0        0         0         0        0           0 #> N42       0             0        0         0         0        0           0 #> N43       1             1        1         0         0        0           0 #> N44       1             1        1         0         0        0           0 #> N45       1             1        1         0         0        0           0 #> N46       0             1        1         0         0        0           0 #> N47       0             0        0         1         1        1           1 #> N48       0             0        0         1         1        1           1 #> N49       0             0        0         1         1        1           1 #> N50       0             0        0         1         1        1           1 #> N51       0             0        0         1         1        0           0 #> N52       0             0        0         0         0        1           1 #> N53       0             0        0         0         0        1           1 #> N54       0             0        0         0         0        0           0 #> N55       0             0        0         0         0        0           0 #> N56       0             0        0         0         0        0           0 #> N57       0             0        0         0         0        0           0 #> N58       0             0        0         0         0        0           0 #> N59       0             0        0         0         0        0           0 #>     A_torques A_budini A_siberiae A_simulator A_varius A_albiventer A_iniscatus #> N31         1        1          1           1        1            1           1 #> N32         1        1          1           1        1            1           1 #> N33         0        0          0           0        0            0           0 #> N34         0        0          0           0        0            0           0 #> N35         0        0          0           0        0            0           0 #> N36         0        0          0           0        0            0           0 #> N37         0        0          0           0        0            0           0 #> N38         0        0          0           0        0            0           0 #> N39         0        0          0           0        0            0           0 #> N40         0        0          0           0        0            0           0 #> N41         0        0          0           0        0            0           0 #> N42         0        0          0           0        0            0           0 #> N43         0        0          0           0        0            0           0 #> N44         0        0          0           0        0            0           0 #> N45         0        0          0           0        0            0           0 #> N46         0        0          0           0        0            0           0 #> N47         1        1          1           1        1            1           1 #> N48         1        1          1           1        1            1           0 #> N49         1        1          1           1        1            0           0 #> N50         1        0          0           0        0            0           0 #> N51         0        0          0           0        0            0           0 #> N52         1        0          0           0        0            0           0 #> N53         0        0          0           0        0            0           0 #> N54         0        1          1           1        1            0           0 #> N55         0        1          1           0        0            0           0 #> N56         0        0          0           1        1            0           0 #> N57         0        0          0           0        0            0           1 #> N58         0        0          0           0        0            0           0 #> N59         0        0          0           0        0            0           0 #>     A_dayi A_toba A_dolores #> N31      1      1         1 #> N32      1      1         1 #> N33      0      0         0 #> N34      0      0         0 #> N35      0      0         0 #> N36      0      0         0 #> N37      0      0         0 #> N38      0      0         0 #> N39      0      0         0 #> N40      0      0         0 #> N41      0      0         0 #> N42      0      0         0 #> N43      0      0         0 #> N44      0      0         0 #> N45      0      0         0 #> N46      0      0         0 #> N47      1      1         1 #> N48      0      0         0 #> N49      0      0         0 #> N50      0      0         0 #> N51      0      0         0 #> N52      0      0         0 #> N53      0      0         0 #> N54      0      0         0 #> N55      0      0         0 #> N56      0      0         0 #> N57      1      1         1 #> N58      1      1         1 #> N59      0      1         1"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/tip_based_trait_evo.html","id":null,"dir":"Reference","previous_headings":"","what":"Tip-based metrics of trait evolution — tip_based_trait_evo","title":"Tip-based metrics of trait evolution — tip_based_trait_evo","text":"Tip-based metrics trait evolution","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/tip_based_trait_evo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tip-based metrics of trait evolution — tip_based_trait_evo","text":"","code":"tip_based_trait_evo(   tree,   trait,   nsim = 1,   method = c(\"transition_rates\", \"last_transition_time\", \"stasis_time\") )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/tip_based_trait_evo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tip-based metrics of trait evolution — tip_based_trait_evo","text":"tree phylogenetic tree object class \"phylo\" trait named vector containing tip states discretely valued character. names must match tip labels tree. nsim Number simulations stochastic character mapping. method Tip-based metric, partial match \"transition_rates\", \"last_transition_time\" \"stasis_time\".","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/tip_based_trait_evo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tip-based metrics of trait evolution — tip_based_trait_evo","text":"list (length equal nsim) tip-based metrics estimated per species.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/tip_based_trait_evo.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Tip-based metrics of trait evolution — tip_based_trait_evo","text":"function calculates three metrics represent macroevolutionary dynamic traits species phylogenetic tree. Transition rates, last transition time stasis time, originally proposed Luza et al (2021). Transition rates indicate many times ancestral character changed time. Stasis time indicates maximum branch length (time interval) current tip-character maintained across whole phylogeny. Finally, last transition time sum branch lengths tip previous node reconstructed character equal current tip-character. Originally function uses stochastic character mapping discrete trait data, types trait reconstruction can used.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/tip_based_trait_evo.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tip-based metrics of trait evolution — tip_based_trait_evo","text":"André Luza Vanderlei Debastiani","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/tipranges_to_BioGeoBEARS.html","id":null,"dir":"Reference","previous_headings":"","what":"Generates lagrangePHYLIP file for using in BioGeoBEARS — tipranges_to_BioGeoBEARS","title":"Generates lagrangePHYLIP file for using in BioGeoBEARS — tipranges_to_BioGeoBEARS","text":"prepares save file used geographical areas BioGeoBEARS scripts. based save_tipranges_to_LagrangePHYLIP function BioGEOBEARS package.","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/tipranges_to_BioGeoBEARS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generates lagrangePHYLIP file for using in BioGeoBEARS — tipranges_to_BioGeoBEARS","text":"","code":"tipranges_to_BioGeoBEARS(   tip_range,   filename = \"lagrange_area_data_file.data\",   areanames = NULL )"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/tipranges_to_BioGeoBEARS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generates lagrangePHYLIP file for using in BioGeoBEARS — tipranges_to_BioGeoBEARS","text":"tip_range data frame. Tip names rows, geographical areas columns. Please provide tip names row.names. See example. filename filename store data. default \"lagrange_area_data_file.data\". areanames names areas. defaut area names generated sequencial upper case letters.","code":""},{"path":[]},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/toy_treeEx.html","id":null,"dir":"Reference","previous_headings":"","what":"Hypothetical phylogenetic tree containing five species — toy_treeEx","title":"Hypothetical phylogenetic tree containing five species — toy_treeEx","text":"made data simulates phylogenetic tree newick format. tree contains five species annotations node corresponds occurrence area ancestors","code":""},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/toy_treeEx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hypothetical phylogenetic tree containing five species — toy_treeEx","text":"","code":"toy_treeEx"},{"path":"https://gabrielnakamura.github.io/Herodotools/reference/toy_treeEx.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Hypothetical phylogenetic tree containing five species — toy_treeEx","text":"newick phylogenetic tree 5 species","code":""}]
